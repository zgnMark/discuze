-- phpMyAdmin SQL Dump
-- version 4.6.4
-- https://www.phpmyadmin.net/
--
-- Host: 127.0.0.1
-- Generation Time: 2017-09-01 06:49:32
-- 服务器版本： 5.7.14
-- PHP Version: 7.0.10

SET SQL_MODE = "NO_AUTO_VALUE_ON_ZERO";
SET time_zone = "+00:00";


/*!40101 SET @OLD_CHARACTER_SET_CLIENT=@@CHARACTER_SET_CLIENT */;
/*!40101 SET @OLD_CHARACTER_SET_RESULTS=@@CHARACTER_SET_RESULTS */;
/*!40101 SET @OLD_COLLATION_CONNECTION=@@COLLATION_CONNECTION */;
/*!40101 SET NAMES utf8mb4 */;

--
-- Database: `discuz`
--

-- --------------------------------------------------------

--
-- 表的结构 `bbs_link`
--

CREATE TABLE `bbs_link` (
  `lid` smallint(6) NOT NULL,
  `web_order` char(20) NOT NULL DEFAULT '0',
  `webname` varchar(30) NOT NULL,
  `url` varchar(255) NOT NULL,
  `words` mediumtext,
  `logo` varchar(255) DEFAULT NULL
) ENGINE=MyISAM DEFAULT CHARSET=utf8;

--
-- 转存表中的数据 `bbs_link`
--

INSERT INTO `bbs_link` (`lid`, `web_order`, `webname`, `url`, `words`, `logo`) VALUES
(1, '1', '官方论坛', 'http://www.discuz.net', '提供最新 Discuz! 产品新闻、软件下载与技术交流', 'public/images/logo_88_31.gif'),
(2, '3', '漫游平台', 'http://www.yhz123.com', '', ''),
(5, '4', '百度', 'http://www.baidu.com', '', ''),
(8, '2', 'discuez', '1234', '22', NULL);

-- --------------------------------------------------------

--
-- 表的结构 `cate_gory`
--

CREATE TABLE `cate_gory` (
  `cid` int(10) NOT NULL,
  `classname` varchar(60) NOT NULL,
  `parentid` int(10) NOT NULL,
  `classpath` char(20) DEFAULT NULL,
  `replycount` int(10) NOT NULL DEFAULT '0',
  `motifcount` int(10) NOT NULL DEFAULT '0',
  `compere` char(10) DEFAULT NULL,
  `classpic` varchar(200) NOT NULL DEFAULT 'public/img/螃蟹.png',
  `description` mediumtext,
  `orderby` smallint(6) NOT NULL DEFAULT '0',
  `lastpost` varchar(600) DEFAULT NULL,
  `namestyle` char(10) DEFAULT NULL,
  `ispass` tinyint(2) NOT NULL DEFAULT '1'
) ENGINE=MyISAM DEFAULT CHARSET=utf8;

--
-- 转存表中的数据 `cate_gory`
--

INSERT INTO `cate_gory` (`cid`, `classname`, `parentid`, `classpath`, `replycount`, `motifcount`, `compere`, `classpic`, `description`, `orderby`, `lastpost`, `namestyle`, `ispass`) VALUES
(3, 'PHP框架', 1, NULL, 0, 0, '1,9', 'public/img/猫头鹰.png', NULL, 3, '这是一个外表粗糙的网站，只有心灵纯洁的人才能看见。', NULL, 1),
(4, '开源产品', 1, NULL, 0, 0, '1', 'public/img/大象.png', NULL, 2, NULL, NULL, 1),
(6, '进阶讨论', 1, NULL, 0, 0, '22', 'public/img/大象.png', NULL, 1, NULL, NULL, 1),
(7, '名人故事', 2, NULL, 0, 0, '1', 'public/img/大象.png', NULL, 1, NULL, NULL, 1),
(8, '经验分享', 2, NULL, 0, 0, '1', 'public/img/猫头鹰.png', NULL, 2, NULL, NULL, 1),
(9, '求职招聘', 2, NULL, 0, 0, '1', 'public/img/狼.png', NULL, 3, NULL, NULL, 1),
(1, 'PHP技术交流', 0, NULL, 0, 0, '', 'public/img/公鸡.png', NULL, 2, NULL, NULL, 1),
(2, '程序人生', 0, NULL, 0, 0, '', 'public/img/公鸡.png', NULL, 1, NULL, NULL, 1),
(10, '我的地带', 0, NULL, 0, 0, NULL, 'public/img/公鸡.png', NULL, 1, NULL, NULL, 1),
(11, 'Faker', 10, NULL, 0, 0, '1', 'public/img/猫头鹰.png', NULL, 1, NULL, NULL, 1),
(13, '好了', 0, NULL, 0, 0, NULL, 'public/img/螃蟹.png', NULL, 0, NULL, NULL, 1),
(14, '酷酷', 12, NULL, 0, 0, NULL, 'public/img/螃蟹.png', NULL, 0, NULL, NULL, 1);

-- --------------------------------------------------------

--
-- 表的结构 `details`
--

CREATE TABLE `details` (
  `id` int(10) NOT NULL,
  `first` tinyint(1) NOT NULL DEFAULT '0',
  `tid` int(10) DEFAULT NULL,
  `authorid` int(10) NOT NULL,
  `title` varchar(600) NOT NULL,
  `content` mediumtext NOT NULL,
  `smiley` smallint(4) DEFAULT NULL,
  `addtime` int(12) NOT NULL,
  `addip` int(12) NOT NULL,
  `classid` int(10) NOT NULL,
  `replycount` int(12) NOT NULL DEFAULT '0',
  `hits` int(12) NOT NULL DEFAULT '0',
  `istop` tinyint(2) NOT NULL DEFAULT '0',
  `elite` tinyint(2) NOT NULL DEFAULT '0',
  `ishot` tinyint(2) NOT NULL DEFAULT '0',
  `rate` smallint(3) NOT NULL DEFAULT '0',
  `attachment` smallint(3) DEFAULT NULL,
  `isdel` tinyint(2) NOT NULL DEFAULT '0',
  `style` char(10) DEFAULT NULL,
  `isdisplay` tinyint(2) NOT NULL DEFAULT '0'
) ENGINE=MyISAM DEFAULT CHARSET=utf8;

--
-- 转存表中的数据 `details`
--

INSERT INTO `details` (`id`, `first`, `tid`, `authorid`, `title`, `content`, `smiley`, `addtime`, `addip`, `classid`, `replycount`, `hits`, `istop`, `elite`, `ishot`, `rate`, `attachment`, `isdel`, `style`, `isdisplay`) VALUES
(2, 1, 0, 1, '深入理解php原理之opcodes', '<table cellpadding="0" cellspacing="0" style="word-wrap: break-word; empty-cells: show; border-collapse: collapse; table-layout: fixed; width: 1141px; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; line-height: 18px;">\r\n  <tbody style="word-wrap: break-word;">\r\n    <tr style="word-wrap: break-word;">\r\n     <td class="t_f" id="postmessage_555349" style="word-wrap: break-word; font-size: 14px;">\r\n        &middot; 作者:laruence(<a href="http://www.laruence.com/" style="word-wrap: break-word; color: rgb(30, 84, 127);" target="_blank">http://www.laruence.com/)</a><br style="word-wrap: break-word;" />\r\n        &middot; 本文地址:&nbsp;<a href="http://www.laruence.com/2008/06/18/221.html" style="word-wrap: break-word; color: rgb(30, 84, 127);" target="_blank">http://www.laruence.com/2008/06/18/221.html</a><br style="word-wrap: break-word;" />\r\n        &middot; 转载请注明出处&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;<br style="word-wrap: break-word;" />\r\n        &nbsp; &nbsp; 最近要给yahoo的同事们做一个关于php和apache处理请求的内部机制的讲座，刚好写了些关于opcodes的文字，就发上来了，这个文章基于 sara golemon的 understanding opcode<br style="word-wrap: break-word;" />\r\n       &nbsp; &nbsp; opcode是一种php脚本编译后的中间语言，就像java的bytecode,或者.net的msl，举个例子，比如你写下了如下的php代码：<br style="word-wrap: break-word;" />\r\n       <font color="blue" style="word-wrap: break-word;">&lt;?php</font><br style="word-wrap: break-word;" />\r\n        <font color="green" style="word-wrap: break-word;">echo</font><br style="word-wrap: break-word;" />\r\n       <font color="#8b0000" style="word-wrap: break-word;">&quot;</font><font color="red" style="word-wrap: break-word;">hello world</font><font color="#8b0000" style="word-wrap: break-word;">&quot;</font><font color="gray" style="word-wrap: break-word;">;<br style="word-wrap: break-word;" />\r\n       &nbsp; &nbsp;</font><font color="#008b00" style="word-wrap: break-word;">$a</font><font color="gray" style="word-wrap: break-word;">&nbsp;=&nbsp;</font><font color="maroon" style="word-wrap: break-word;">1</font><font color="gray" style="word-wrap: break-word;">&nbsp;+&nbsp;</font><font color="maroon" style="word-wrap: break-word;">1</font><font color="gray" style="word-wrap: break-word;">;<br style="word-wrap: break-word;" />\r\n        &nbsp; &nbsp;</font><font color="green" style="word-wrap: break-word;">echo</font><br style="word-wrap: break-word;" />\r\n       <font color="#008b00" style="word-wrap: break-word;">$a</font><font color="gray" style="word-wrap: break-word;">;</font><br style="word-wrap: break-word;" />\r\n       <font color="blue" style="word-wrap: break-word;">?&gt;</font><br style="word-wrap: break-word;" />\r\n       <br style="word-wrap: break-word;" />\r\n       &nbsp;&nbsp;php执行这段代码会经过如下4个步骤(确切的来说，应该是php的语言引擎zend)<br style="word-wrap: break-word;" />\r\n        1.&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;scanning(lexing) ,将php代码转换为语言片段(tokens)<br style="word-wrap: break-word;" />\r\n       2.&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;parsing, 将tokens转换成简单而有意义的表达式<br style="word-wrap: break-word;" />\r\n       3.&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;compilation, 将表达式编译成opocdes<br style="word-wrap: break-word;" />\r\n       4.&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;execution, 顺次执行opcodes，每次一条，从而实现php脚本的功能。<br style="word-wrap: break-word;" />\r\n       &nbsp; &nbsp;题外话:现在有的cache比如apc,可以使得php缓存住opcodes，这样，每次有请求来临的时候，就不需要重复执行前面3步，从而能大幅的提高php的执行速度。<br style="word-wrap: break-word;" />\r\n       那什么是lexing? 学过编译原理的同学都应该对编译原理中的词法分析步骤有所了解，lex就是一个词法分析的依据表。zend/zend_language_scanner.c会根据zend/zend_language_scanner.l(lex文件),来对输入的php代码进行词法分析，从而得到一个一个的&ldquo;词&rdquo;，php4.2开始提供了一个函数叫token_get_all,这个函数就可以讲一段php代码scanning成tokens；<br style="word-wrap: break-word;" />\r\n       &nbsp;&nbsp;如果用这个函数处理我们开头提到的php代码，将会得到如下结果:<br style="word-wrap: break-word;" />\r\n        <font color="green" style="word-wrap: break-word;">array</font><br style="word-wrap: break-word;" />\r\n        <font color="olive" style="word-wrap: break-word;">(</font><br style="word-wrap: break-word;" />\r\n        <font color="olive" style="word-wrap: break-word;">[</font><font color="maroon" style="word-wrap: break-word;">0</font><font color="olive" style="word-wrap: break-word;">]</font><font color="gray" style="word-wrap: break-word;">&nbsp;=&gt;&nbsp;</font><font color="green" style="word-wrap: break-word;">array</font><br style="word-wrap: break-word;" />\r\n        <font color="olive" style="word-wrap: break-word;">(</font><br style="word-wrap: break-word;" />\r\n        <font color="olive" style="word-wrap: break-word;">[</font><font color="maroon" style="word-wrap: break-word;">0</font><font color="olive" style="word-wrap: break-word;">]</font><font color="gray" style="word-wrap: break-word;">&nbsp;=&gt;&nbsp;</font><font color="maroon" style="word-wrap: break-word;">367</font><br style="word-wrap: break-word;" />\r\n       <font color="olive" style="word-wrap: break-word;">[</font><font color="maroon" style="word-wrap: break-word;">1</font><font color="olive" style="word-wrap: break-word;">]</font><font color="gray" style="word-wrap: break-word;">&nbsp;=&gt;&nbsp;&nbsp;</font><font color="green" style="word-wrap: break-word;">array</font><br style="word-wrap: break-word;" />\r\n        <font color="olive" style="word-wrap: break-word;">(</font><br style="word-wrap: break-word;" />\r\n        <font color="olive" style="word-wrap: break-word;">[</font><font color="maroon" style="word-wrap: break-word;">0</font><font color="olive" style="word-wrap: break-word;">]</font><font color="gray" style="word-wrap: break-word;">&nbsp;=&gt;&nbsp;</font><font color="maroon" style="word-wrap: break-word;">316</font><br style="word-wrap: break-word;" />\r\n       <font color="olive" style="word-wrap: break-word;">[</font><font color="maroon" style="word-wrap: break-word;">1</font><font color="olive" style="word-wrap: break-word;">]</font><font color="gray" style="word-wrap: break-word;">&nbsp;=&gt;&nbsp;</font><font color="green" style="word-wrap: break-word;">echo</font><br style="word-wrap: break-word;" />\r\n       <font color="olive" style="word-wrap: break-word;">)</font><br style="word-wrap: break-word;" />\r\n        <font color="olive" style="word-wrap: break-word;">[</font><font color="maroon" style="word-wrap: break-word;">2</font><font color="olive" style="word-wrap: break-word;">]</font><font color="gray" style="word-wrap: break-word;">&nbsp;=&gt;&nbsp;</font><font color="green" style="word-wrap: break-word;">array</font><br style="word-wrap: break-word;" />\r\n        <font color="olive" style="word-wrap: break-word;">(</font><br style="word-wrap: break-word;" />\r\n        <font color="olive" style="word-wrap: break-word;">[</font><font color="maroon" style="word-wrap: break-word;">0</font><font color="olive" style="word-wrap: break-word;">]</font><font color="gray" style="word-wrap: break-word;">&nbsp;=&gt;&nbsp;</font><font color="maroon" style="word-wrap: break-word;">370</font><br style="word-wrap: break-word;" />\r\n       <font color="olive" style="word-wrap: break-word;">[</font><font color="maroon" style="word-wrap: break-word;">1</font><font color="olive" style="word-wrap: break-word;">]</font><font color="gray" style="word-wrap: break-word;">&nbsp;=&gt;<br style="word-wrap: break-word;" />\r\n        <br style="word-wrap: break-word;" />\r\n       &nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;</font><font color="olive" style="word-wrap: break-word;">)</font><br style="word-wrap: break-word;" />\r\n       <font color="olive" style="word-wrap: break-word;">[</font><font color="maroon" style="word-wrap: break-word;">3</font><font color="olive" style="word-wrap: break-word;">]</font><font color="gray" style="word-wrap: break-word;">&nbsp;=&gt;&nbsp;</font><font color="green" style="word-wrap: break-word;">array</font><br style="word-wrap: break-word;" />\r\n        <font color="olive" style="word-wrap: break-word;">(</font><br style="word-wrap: break-word;" />\r\n        <font color="olive" style="word-wrap: break-word;">[</font><font color="maroon" style="word-wrap: break-word;">0</font><font color="olive" style="word-wrap: break-word;">]</font><font color="gray" style="word-wrap: break-word;">&nbsp;=&gt;&nbsp;</font><font color="maroon" style="word-wrap: break-word;">315</font><br style="word-wrap: break-word;" />\r\n       <font color="olive" style="word-wrap: break-word;">[</font><font color="maroon" style="word-wrap: break-word;">1</font><font color="olive" style="word-wrap: break-word;">]</font><font color="gray" style="word-wrap: break-word;">&nbsp;=&gt;&nbsp;</font><font color="#8b0000" style="word-wrap: break-word;">&quot;</font><font color="red" style="word-wrap: break-word;">hello world</font><font color="#8b0000" style="word-wrap: break-word;">&quot;</font><br style="word-wrap: break-word;" />\r\n        <font color="olive" style="word-wrap: break-word;">)</font><br style="word-wrap: break-word;" />\r\n        <font color="olive" style="word-wrap: break-word;">[</font><font color="maroon" style="word-wrap: break-word;">4</font><font color="olive" style="word-wrap: break-word;">]</font><font color="gray" style="word-wrap: break-word;">&nbsp;=&gt; ;<br style="word-wrap: break-word;" />\r\n        <br style="word-wrap: break-word;" />\r\n       &nbsp; &nbsp;&nbsp;</font><font color="olive" style="word-wrap: break-word;">[</font><font color="maroon" style="word-wrap: break-word;">5</font><font color="olive" style="word-wrap: break-word;">]</font><font color="gray" style="word-wrap: break-word;">&nbsp;=&gt;&nbsp;</font><font color="green" style="word-wrap: break-word;">array</font><br style="word-wrap: break-word;" />\r\n        <font color="olive" style="word-wrap: break-word;">(</font><br style="word-wrap: break-word;" />\r\n        <font color="olive" style="word-wrap: break-word;">[</font><font color="maroon" style="word-wrap: break-word;">0</font><font color="olive" style="word-wrap: break-word;">]</font><font color="gray" style="word-wrap: break-word;">&nbsp;=&gt;&nbsp;</font><font color="maroon" style="word-wrap: break-word;">370</font><br style="word-wrap: break-word;" />\r\n       <font color="olive" style="word-wrap: break-word;">[</font><font color="maroon" style="word-wrap: break-word;">1</font><font color="olive" style="word-wrap: break-word;">]</font><font color="gray" style="word-wrap: break-word;">&nbsp;=&gt;<br style="word-wrap: break-word;" />\r\n        <br style="word-wrap: break-word;" />\r\n       &nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;</font><font color="olive" style="word-wrap: break-word;">)</font><br style="word-wrap: break-word;" />\r\n       <font color="olive" style="word-wrap: break-word;">[</font><font color="maroon" style="word-wrap: break-word;">6</font><font color="olive" style="word-wrap: break-word;">]</font><font color="gray" style="word-wrap: break-word;">&nbsp;=&gt; =<br style="word-wrap: break-word;" />\r\n        <br style="word-wrap: break-word;" />\r\n       &nbsp; &nbsp;&nbsp;</font><font color="olive" style="word-wrap: break-word;">[</font><font color="maroon" style="word-wrap: break-word;">7</font><font color="olive" style="word-wrap: break-word;">]</font><font color="gray" style="word-wrap: break-word;">&nbsp;=&gt;&nbsp;</font><font color="green" style="word-wrap: break-word;">array</font><br style="word-wrap: break-word;" />\r\n        <font color="olive" style="word-wrap: break-word;">(</font><br style="word-wrap: break-word;" />\r\n        <font color="olive" style="word-wrap: break-word;">[</font><font color="maroon" style="word-wrap: break-word;">0</font><font color="olive" style="word-wrap: break-word;">]</font><font color="gray" style="word-wrap: break-word;">&nbsp;=&gt;&nbsp;</font><font color="maroon" style="word-wrap: break-word;">370</font><br style="word-wrap: break-word;" />\r\n       <font color="olive" style="word-wrap: break-word;">[</font><font color="maroon" style="word-wrap: break-word;">1</font><font color="olive" style="word-wrap: break-word;">]</font><font color="gray" style="word-wrap: break-word;">&nbsp;=&gt;<br style="word-wrap: break-word;" />\r\n        <br style="word-wrap: break-word;" />\r\n       &nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;</font><font color="olive" style="word-wrap: break-word;">)</font><br style="word-wrap: break-word;" />\r\n       <font color="olive" style="word-wrap: break-word;">[</font><font color="maroon" style="word-wrap: break-word;">8</font><font color="olive" style="word-wrap: break-word;">]</font><font color="gray" style="word-wrap: break-word;">&nbsp;=&gt;&nbsp;</font><font color="green" style="word-wrap: break-word;">array</font><br style="word-wrap: break-word;" />\r\n        <font color="olive" style="word-wrap: break-word;">(</font><br style="word-wrap: break-word;" />\r\n        <font color="olive" style="word-wrap: break-word;">[</font><font color="maroon" style="word-wrap: break-word;">0</font><font color="olive" style="word-wrap: break-word;">]</font><font color="gray" style="word-wrap: break-word;">&nbsp;=&gt;&nbsp;</font><font color="maroon" style="word-wrap: break-word;">305</font><br style="word-wrap: break-word;" />\r\n       <font color="olive" style="word-wrap: break-word;">[</font><font color="maroon" style="word-wrap: break-word;">1</font><font color="olive" style="word-wrap: break-word;">]</font><font color="gray" style="word-wrap: break-word;">&nbsp;=&gt;&nbsp;</font><font color="maroon" style="word-wrap: break-word;">1</font><br style="word-wrap: break-word;" />\r\n       <font color="olive" style="word-wrap: break-word;">)</font><br style="word-wrap: break-word;" />\r\n        <font color="olive" style="word-wrap: break-word;">[</font><font color="maroon" style="word-wrap: break-word;">9</font><font color="olive" style="word-wrap: break-word;">]</font><font color="gray" style="word-wrap: break-word;">&nbsp;=&gt;&nbsp;</font><font color="green" style="word-wrap: break-word;">array</font><br style="word-wrap: break-word;" />\r\n        <font color="olive" style="word-wrap: break-word;">(</font><br style="word-wrap: break-word;" />\r\n        <font color="olive" style="word-wrap: break-word;">[</font><font color="maroon" style="word-wrap: break-word;">0</font><font color="olive" style="word-wrap: break-word;">]</font><font color="gray" style="word-wrap: break-word;">&nbsp;=&gt;&nbsp;</font><font color="maroon" style="word-wrap: break-word;">370</font><br style="word-wrap: break-word;" />\r\n       <font color="olive" style="word-wrap: break-word;">[</font><font color="maroon" style="word-wrap: break-word;">1</font><font color="olive" style="word-wrap: break-word;">]</font><font color="gray" style="word-wrap: break-word;">&nbsp;=&gt;<br style="word-wrap: break-word;" />\r\n        <br style="word-wrap: break-word;" />\r\n       &nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;</font><font color="olive" style="word-wrap: break-word;">)</font><br style="word-wrap: break-word;" />\r\n       <font color="olive" style="word-wrap: break-word;">[</font><font color="maroon" style="word-wrap: break-word;">10</font><font color="olive" style="word-wrap: break-word;">]</font><font color="gray" style="word-wrap: break-word;">&nbsp;=&gt; +<br style="word-wrap: break-word;" />\r\n       <br style="word-wrap: break-word;" />\r\n       &nbsp; &nbsp;&nbsp;</font><font color="olive" style="word-wrap: break-word;">[</font><font color="maroon" style="word-wrap: break-word;">11</font><font color="olive" style="word-wrap: break-word;">]</font><font color="gray" style="word-wrap: break-word;">&nbsp;=&gt;&nbsp;</font><font color="green" style="word-wrap: break-word;">array</font><br style="word-wrap: break-word;" />\r\n       <font color="olive" style="word-wrap: break-word;">(</font><br style="word-wrap: break-word;" />\r\n        <font color="olive" style="word-wrap: break-word;">[</font><font color="maroon" style="word-wrap: break-word;">0</font><font color="olive" style="word-wrap: break-word;">]</font><font color="gray" style="word-wrap: break-word;">&nbsp;=&gt;&nbsp;</font><font color="maroon" style="word-wrap: break-word;">370</font><br style="word-wrap: break-word;" />\r\n       <font color="olive" style="word-wrap: break-word;">[</font><font color="maroon" style="word-wrap: break-word;">1</font><font color="olive" style="word-wrap: break-word;">]</font><font color="gray" style="word-wrap: break-word;">&nbsp;=&gt;<br style="word-wrap: break-word;" />\r\n        <br style="word-wrap: break-word;" />\r\n       &nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;</font><font color="olive" style="word-wrap: break-word;">)</font><br style="word-wrap: break-word;" />\r\n       <font color="olive" style="word-wrap: break-word;">[</font><font color="maroon" style="word-wrap: break-word;">12</font><font color="olive" style="word-wrap: break-word;">]</font><font color="gray" style="word-wrap: break-word;">&nbsp;=&gt;&nbsp;</font><font color="green" style="word-wrap: break-word;">array</font><br style="word-wrap: break-word;" />\r\n       <font color="olive" style="word-wrap: break-word;">(</font><br style="word-wrap: break-word;" />\r\n        <font color="olive" style="word-wrap: break-word;">[</font><font color="maroon" style="word-wrap: break-word;">0</font><font color="olive" style="word-wrap: break-word;">]</font><font color="gray" style="word-wrap: break-word;">&nbsp;=&gt;&nbsp;</font><font color="maroon" style="word-wrap: break-word;">305</font><br style="word-wrap: break-word;" />\r\n       <font color="olive" style="word-wrap: break-word;">[</font><font color="maroon" style="word-wrap: break-word;">1</font><font color="olive" style="word-wrap: break-word;">]</font><font color="gray" style="word-wrap: break-word;">&nbsp;=&gt;&nbsp;</font><font color="maroon" style="word-wrap: break-word;">1</font><br style="word-wrap: break-word;" />\r\n       <font color="olive" style="word-wrap: break-word;">)</font><br style="word-wrap: break-word;" />\r\n        <font color="olive" style="word-wrap: break-word;">[</font><font color="maroon" style="word-wrap: break-word;">13</font><font color="olive" style="word-wrap: break-word;">]</font><font color="gray" style="word-wrap: break-word;">&nbsp;=&gt; ;<br style="word-wrap: break-word;" />\r\n       <br style="word-wrap: break-word;" />\r\n       &nbsp; &nbsp;&nbsp;</font><font color="olive" style="word-wrap: break-word;">[</font><font color="maroon" style="word-wrap: break-word;">14</font><font color="olive" style="word-wrap: break-word;">]</font><font color="gray" style="word-wrap: break-word;">&nbsp;=&gt;&nbsp;</font><font color="green" style="word-wrap: break-word;">array</font><br style="word-wrap: break-word;" />\r\n       <font color="olive" style="word-wrap: break-word;">(</font><br style="word-wrap: break-word;" />\r\n        <font color="olive" style="word-wrap: break-word;">[</font><font color="maroon" style="word-wrap: break-word;">0</font><font color="olive" style="word-wrap: break-word;">]</font><font color="gray" style="word-wrap: break-word;">&nbsp;=&gt;&nbsp;</font><font color="maroon" style="word-wrap: break-word;">370</font><br style="word-wrap: break-word;" />\r\n       <font color="olive" style="word-wrap: break-word;">[</font><font color="maroon" style="word-wrap: break-word;">1</font><font color="olive" style="word-wrap: break-word;">]</font><font color="gray" style="word-wrap: break-word;">&nbsp;=&gt;<br style="word-wrap: break-word;" />\r\n        <br style="word-wrap: break-word;" />\r\n       &nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;</font><font color="olive" style="word-wrap: break-word;">)</font><br style="word-wrap: break-word;" />\r\n       <font color="olive" style="word-wrap: break-word;">[</font><font color="maroon" style="word-wrap: break-word;">15</font><font color="olive" style="word-wrap: break-word;">]</font><font color="gray" style="word-wrap: break-word;">&nbsp;=&gt;&nbsp;</font><font color="green" style="word-wrap: break-word;">array</font><br style="word-wrap: break-word;" />\r\n       <font color="olive" style="word-wrap: break-word;">(</font><br style="word-wrap: break-word;" />\r\n        <font color="olive" style="word-wrap: break-word;">[</font><font color="maroon" style="word-wrap: break-word;">0</font><font color="olive" style="word-wrap: break-word;">]</font><font color="gray" style="word-wrap: break-word;">&nbsp;=&gt;&nbsp;</font><font color="maroon" style="word-wrap: break-word;">316</font><br style="word-wrap: break-word;" />\r\n       <font color="olive" style="word-wrap: break-word;">[</font><font color="maroon" style="word-wrap: break-word;">1</font><font color="olive" style="word-wrap: break-word;">]</font><font color="gray" style="word-wrap: break-word;">&nbsp;=&gt;&nbsp;</font><font color="green" style="word-wrap: break-word;">echo</font><br style="word-wrap: break-word;" />\r\n       <font color="olive" style="word-wrap: break-word;">)</font><br style="word-wrap: break-word;" />\r\n        <font color="olive" style="word-wrap: break-word;">[</font><font color="maroon" style="word-wrap: break-word;">16</font><font color="olive" style="word-wrap: break-word;">]</font><font color="gray" style="word-wrap: break-word;">&nbsp;=&gt;&nbsp;</font><font color="green" style="word-wrap: break-word;">array</font><br style="word-wrap: break-word;" />\r\n       <font color="olive" style="word-wrap: break-word;">(</font><br style="word-wrap: break-word;" />\r\n        <font color="olive" style="word-wrap: break-word;">[</font><font color="maroon" style="word-wrap: break-word;">0</font><font color="olive" style="word-wrap: break-word;">]</font><font color="gray" style="word-wrap: break-word;">&nbsp;=&gt;&nbsp;</font><font color="maroon" style="word-wrap: break-word;">370</font><br style="word-wrap: break-word;" />\r\n       <font color="olive" style="word-wrap: break-word;">[</font><font color="maroon" style="word-wrap: break-word;">1</font><font color="olive" style="word-wrap: break-word;">]</font><font color="gray" style="word-wrap: break-word;">&nbsp;=&gt;<br style="word-wrap: break-word;" />\r\n        <br style="word-wrap: break-word;" />\r\n       &nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;</font><font color="olive" style="word-wrap: break-word;">)</font><br style="word-wrap: break-word;" />\r\n       <font color="olive" style="word-wrap: break-word;">[</font><font color="maroon" style="word-wrap: break-word;">17</font><font color="olive" style="word-wrap: break-word;">]</font><font color="gray" style="word-wrap: break-word;">&nbsp;=&gt; ;</font><br style="word-wrap: break-word;" />\r\n        <br style="word-wrap: break-word;" />\r\n       <font color="olive" style="word-wrap: break-word;">)</font><br style="word-wrap: break-word;" />\r\n        <font color="gray" style="word-wrap: break-word;">?&gt;</font><br style="word-wrap: break-word;" />\r\n       <br style="word-wrap: break-word;" />\r\n       分析这个返回结果我们可以发现，源码中的字符串，字符，空格，都会原样返回。每个源代码中的字符，都会出现在相应的顺序处。而，其他的比如标签，操作符，语句，都会被转换成一个包含俩部分的array: token id(也就是在zend内部的改token的对应码，比如,t_echo,t_string)，和源码中的原来的内容。<br style="word-wrap: break-word;" />\r\n       &nbsp;&nbsp;接下来，就是parsing阶段了，parsing首先会丢弃tokens array中的多于的空格，然后将剩余的tokens转换成一个一个的简单的表达式<br style="word-wrap: break-word;" />\r\n        1.&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;echo a constant string<br style="word-wrap: break-word;" />\r\n        2.&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;add two numbers together<br style="word-wrap: break-word;" />\r\n        3.&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;store the result of the prior expression to a variable<br style="word-wrap: break-word;" />\r\n        4.&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;echo a variable<br style="word-wrap: break-word;" />\r\n       然后就改compilation阶段了，它会把tokens编译成一个个op_array, 每个op_arrayd包含如下5个部分：<br style="word-wrap: break-word;" />\r\n       1.&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;opcode数字的标识，指明了每个op_array的操作类型，比如add , echo<br style="word-wrap: break-word;" />\r\n       2.&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;结果&nbsp; &nbsp;&nbsp; &nbsp; 存放opcode结果<br style="word-wrap: break-word;" />\r\n       3.&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;操作数1&nbsp;&nbsp;给opcode的操作数<br style="word-wrap: break-word;" />\r\n       4.&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;操作数2<br style="word-wrap: break-word;" />\r\n        5.&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;扩展值&nbsp; &nbsp;1个整形用来区别被重载的操作符<br style="word-wrap: break-word;" />\r\n       &nbsp;&nbsp;比如，我们的php代码会被parsing成:<br style="word-wrap: break-word;" />\r\n       <font color="gray" style="word-wrap: break-word;">*&nbsp;</font><font color="blue" style="word-wrap: break-word;">zend_echo</font><font color="gray" style="word-wrap: break-word;">&nbsp; &nbsp;&nbsp;&nbsp;&#39;</font><font color="blue" style="word-wrap: break-word;">hello</font><br style="word-wrap: break-word;" />\r\n        <font color="blue" style="word-wrap: break-word;">world</font><font color="gray" style="word-wrap: break-word;">&#39;<br style="word-wrap: break-word;" />\r\n        &nbsp; &nbsp; *&nbsp;</font><font color="blue" style="word-wrap: break-word;">zend_add</font><font color="gray" style="word-wrap: break-word;">&nbsp; &nbsp;&nbsp; &nbsp; ~</font><font color="maroon" style="word-wrap: break-word;">0</font><br style="word-wrap: break-word;" />\r\n       <font color="maroon" style="word-wrap: break-word;">1</font><br style="word-wrap: break-word;" />\r\n       <font color="maroon" style="word-wrap: break-word;">1</font><br style="word-wrap: break-word;" />\r\n       <font color="gray" style="word-wrap: break-word;">&nbsp; &nbsp; *&nbsp;</font><font color="blue" style="word-wrap: break-word;">zend_assign</font><font color="gray" style="word-wrap: break-word;">&nbsp;&nbsp;!</font><font color="maroon" style="word-wrap: break-word;">0</font><font color="gray" style="word-wrap: break-word;">&nbsp;~</font><font color="maroon" style="word-wrap: break-word;">0</font><br style="word-wrap: break-word;" />\r\n       <font color="gray" style="word-wrap: break-word;">&nbsp; &nbsp; *&nbsp;</font><font color="blue" style="word-wrap: break-word;">zend_echo</font><font color="gray" style="word-wrap: break-word;">&nbsp; &nbsp;&nbsp;&nbsp;!</font><font color="maroon" style="word-wrap: break-word;">0</font><br style="word-wrap: break-word;" />\r\n        <br style="word-wrap: break-word;" />\r\n       呵呵，你可能会问了，我们的$a去那里了？<br style="word-wrap: break-word;" />\r\n       &nbsp; &nbsp;&nbsp; &nbsp; 恩，这个要介绍操作数了，每个操作数都是由以下俩个部分组成：<br style="word-wrap: break-word;" />\r\n       a)&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;op_type : 为is_const, is_tmp_var, is_var, is_unused, or is_cv<br style="word-wrap: break-word;" />\r\n        b)&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;u,一个联合体，根据op_type的不同，分别用不同的类型保存了这个操作数的值(const)或者左值(var)<br style="word-wrap: break-word;" />\r\n        &nbsp; &nbsp;&nbsp; &nbsp; 而对于var来说，每个var也不一样<br style="word-wrap: break-word;" />\r\n        &nbsp; &nbsp;&nbsp; &nbsp; is_tmp_var, 顾名思义，这个是一个临时变量，保存一些op_array的结果，以便接下来的op_array使用，这种的操作数的u保存着一个指向变量表的一个句柄（整数），这种操作数一般用~开头，比如~0,表示变量表的0号未知的临时变量<br style="word-wrap: break-word;" />\r\n        is_var 这种就是我们一般意义上的变量了,他们以$开头表示<br style="word-wrap: break-word;" />\r\n        is_cv 表示ze2.1/php5.1以后的编译器使用的一种cache机制，这种变量保存着被它引用的变量的地址，当一个变量第一次被引用的时候，就会被cv起来，以后对这个变量的引用就不需要再次去查找active符号表了，cv变量以！开头表示。<br style="word-wrap: break-word;" />\r\n        &nbsp; &nbsp;这么看来，我们的$a被优化成!0了。</td>\r\n    </tr>\r\n </tbody>\r\n</table>\r\n<p>\r\n &nbsp;</p>', NULL, 1444300799, -1062731039, 5, 0, 1, 0, 0, 0, 0, NULL, 0, NULL, 0),
(3, 1, 0, 1, 'seaslog: 高效、便捷、稳定的php日志扩展', '<p>\r\n  <span style="word-wrap: break-word; font-weight: 700; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">简介</span><span style="word-wrap: break-word; font-weight: 700; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">为什么使用seaslog</span></p>\r\n<div align="left" style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">\r\n <font style="word-wrap: break-word; color: rgb(51, 51, 51);"><font face="helvetica, arial, freesans, clean, sans-serif" style="word-wrap: break-word;"><font style="word-wrap: break-word; font-size: 15px;">log日志，通常是系统或软件、应用的运行记录。通过log的分析，可以方便用户了解系统或软件、应用的运行情况；如果你的应用log足够丰富，也可以分析以往用户的操作行为、类型喜好、地域分布或其他更多信息；如果一个应用的log同时也分了多个级别，那么可以很轻易地分析得到该应用的健康状况，及时发现问题并快速定位、解决问题，补救损失。</font></font></font></div>\r\n<div align="left" style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">\r\n  <font style="word-wrap: break-word; color: rgb(51, 51, 51);"><font face="helvetica, arial, freesans, clean, sans-serif" style="word-wrap: break-word;"><font style="word-wrap: break-word; font-size: 15px;">php内置error_log、syslog函数功能强大且性能极好，但由于各种缺陷(error_log无错误级别、无固定格式，syslog不分模块、与系统日志混合)，灵活度降低了很多，不能满足应用需求。</font></font></font></div>\r\n<div align="left" style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">\r\n <font style="word-wrap: break-word; color: rgb(51, 51, 51);"><font face="helvetica, arial, freesans, clean, sans-serif" style="word-wrap: break-word;"><font style="word-wrap: break-word; font-size: 15px;">好消息是，有不少第三方的log类库弥补了上述缺陷，如log4php、plog、analog等(当然也有很多应用在项目中自己开发的log类)。其中以<font style="word-wrap: break-word; color: rgb(65, 131, 196);">log4php</font>最为著名，设计精良、格式完美、文档完善、功能强大。推荐。(log4php的性能有待测试)</font></font></font></div>\r\n<div align="left" style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">\r\n <font style="word-wrap: break-word; color: rgb(51, 51, 51);"><font face="helvetica, arial, freesans, clean, sans-serif" style="word-wrap: break-word;"><font style="word-wrap: break-word; font-size: 15px;">那么有没有一种log类库满足以下需求呢：</font></font></font></div>\r\n<ul style="word-wrap: break-word; margin: 0px 0px 0px 14px; padding-right: 0px; padding-left: 0px; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">\r\n  <li style="word-wrap: break-word; margin: 0px 0px 0px 2em; padding: 0px; list-style: disc;">\r\n    分模块、分级别</li>\r\n  <li style="word-wrap: break-word; margin: 0px 0px 0px 2em; padding: 0px; list-style: disc;">\r\n    配置简单(最好是勿须配置)</li>\r\n  <li style="word-wrap: break-word; margin: 0px 0px 0px 2em; padding: 0px; list-style: disc;">\r\n    日志格式清晰易读</li>\r\n <li style="word-wrap: break-word; margin: 0px 0px 0px 2em; padding: 0px; list-style: disc;">\r\n    应用简单、性能很棒</li>\r\n</ul>\r\n<div align="left" style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">\r\n  <font style="word-wrap: break-word; color: rgb(51, 51, 51);"><font face="helvetica, arial, freesans, clean, sans-serif" style="word-wrap: break-word;"><font style="word-wrap: break-word; font-size: 15px;">seaslog 正是应此需求而生。</font></font></font></div>\r\n<p>\r\n  <span style="word-wrap: break-word; font-weight: 700; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">目前提供了什么</span></p>\r\n<ul style="word-wrap: break-word; margin: 0px 0px 0px 14px; padding-right: 0px; padding-left: 0px; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">\r\n <li style="word-wrap: break-word; margin: 0px 0px 0px 2em; padding: 0px; list-style: disc;">\r\n    在php项目中便捷、规范地记录log</li>\r\n <li style="word-wrap: break-word; margin: 0px 0px 0px 2em; padding: 0px; list-style: disc;">\r\n    可配置的默认log目录与模块</li>\r\n <li style="word-wrap: break-word; margin: 0px 0px 0px 2em; padding: 0px; list-style: disc;">\r\n    指定log目录与获取当前配置</li>\r\n <li style="word-wrap: break-word; margin: 0px 0px 0px 2em; padding: 0px; list-style: disc;">\r\n    初步的分析预警框架</li>\r\n  <li style="word-wrap: break-word; margin: 0px 0px 0px 2em; padding: 0px; list-style: disc;">\r\n    高效的日志缓冲、便捷的缓冲debug</li>\r\n</ul>\r\n<p>\r\n <span style="word-wrap: break-word; font-weight: 700; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">目标是怎样的</span></p>\r\n<ul style="word-wrap: break-word; margin: 0px 0px 0px 14px; padding-right: 0px; padding-left: 0px; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">\r\n  <li style="word-wrap: break-word; margin: 0px 0px 0px 2em; padding: 0px; list-style: disc;">\r\n    便捷、规范的log记录</li>\r\n  <li style="word-wrap: break-word; margin: 0px 0px 0px 2em; padding: 0px; list-style: disc;">\r\n    高效的海量log分析</li>\r\n <li style="word-wrap: break-word; margin: 0px 0px 0px 2em; padding: 0px; list-style: disc;">\r\n    可配置、多途径的log预警</li>\r\n</ul>\r\n<p>\r\n  <span style="word-wrap: break-word; font-weight: 700; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">安装</span><span style="word-wrap: break-word; font-weight: 700; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">编译安装 seaslog</span></p>\r\n<div class="blockcode" style="word-wrap: break-word; overflow: hidden; margin: 10px 0px; padding: 10px 0px 5px 10px; color: rgb(102, 102, 102); zoom: 1; border: 1px solid rgb(204, 204, 204); background: url(http://bbs.phpchina.com/template/yeei_dream1/css/yeei//codebg.gif) 0px 0px repeat-y rgb(247, 247, 247);">\r\n  <div id="code_kjo" style="word-wrap: break-word;">\r\n    <ol style="word-wrap: break-word; margin: 0px 0px 0px 10px !important; padding-right: 0px !important; padding-left: 0px !important;">\r\n     <li style="word-wrap: break-word; margin: 0px 0px 0px 2em; padding: 0px 0px 0px 10px; list-style-type: decimal-leading-zero; font-family: monaco, consolas, \'lucida console\', \'courier new\', serif; line-height: 1.8em;">\r\n       <font face="helvetica, arial, freesans, clean, sans-serif" style="word-wrap: break-word; color: rgb(68, 68, 68); font-size: 14px; line-height: 21px;"><font color="#008080" style="word-wrap: break-word;"><font style="word-wrap: break-word; font-size: 15px;"><span style="word-wrap: break-word; font-weight: 700;">$ /path/to/phpize</span></font></font></font></li>\r\n      <li style="word-wrap: break-word; margin: 0px 0px 0px 2em; padding: 0px 0px 0px 10px; list-style-type: decimal-leading-zero; font-family: monaco, consolas, \'lucida console\', \'courier new\', serif; line-height: 1.8em;">\r\n       <font face="helvetica, arial, freesans, clean, sans-serif" style="word-wrap: break-word; color: rgb(68, 68, 68); font-size: 14px; line-height: 21px;"><font color="#008080" style="word-wrap: break-word;"><font style="word-wrap: break-word; font-size: 15px;"><span style="word-wrap: break-word; font-weight: 700;">$ ./configure --with-php-config=/path/to/php-config</span></font></font></font></li>\r\n      <li style="word-wrap: break-word; margin: 0px 0px 0px 2em; padding: 0px 0px 0px 10px; list-style-type: decimal-leading-zero; font-family: monaco, consolas, \'lucida console\', \'courier new\', serif; line-height: 1.8em;">\r\n       <font face="helvetica, arial, freesans, clean, sans-serif" style="word-wrap: break-word; color: rgb(68, 68, 68); font-size: 14px; line-height: 21px;"><font color="#008080" style="word-wrap: break-word;"><font style="word-wrap: break-word; font-size: 15px;"><span style="word-wrap: break-word; font-weight: 700;">$ make &amp;&amp; make install</span></font></font></font></li>\r\n   </ol>\r\n </div>\r\n  <font face="helvetica, arial, freesans, clean, sans-serif" style="word-wrap: break-word; color: rgb(68, 68, 68); font-size: 14px; line-height: 21px;"><font color="#008080" style="word-wrap: break-word;"><font style="word-wrap: break-word; font-size: 15px;"><span style="word-wrap: break-word; font-weight: 700;"><span style="word-wrap: break-word; margin-left: 43px; font-size: 12px; cursor: pointer; color: rgb(30, 84, 127) !important;">复制代码</span></span></font></font></font></div>\r\n<p>\r\n  <br style="word-wrap: break-word;" />\r\n <br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="word-wrap: break-word; font-weight: 700; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">seaslog.ini的配置</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n &nbsp;</p>\r\n<div class="blockcode" style="word-wrap: break-word; overflow: hidden; margin: 10px 0px; padding: 10px 0px 5px 10px; color: rgb(102, 102, 102); zoom: 1; border: 1px solid rgb(204, 204, 204); background: url(http://bbs.phpchina.com/template/yeei_dream1/css/yeei//codebg.gif) 0px 0px repeat-y rgb(247, 247, 247);">\r\n  <div id="code_fii" style="word-wrap: break-word;">\r\n    <ol style="word-wrap: break-word; margin: 0px 0px 0px 10px !important; padding-right: 0px !important; padding-left: 0px !important;">\r\n     <li style="word-wrap: break-word; margin: 0px 0px 0px 2em; padding: 0px 0px 0px 10px; list-style-type: decimal-leading-zero; font-family: monaco, consolas, \'lucida console\', \'courier new\', serif; line-height: 1.8em;">\r\n       <font face="helvetica, arial, freesans, clean, sans-serif" style="word-wrap: break-word; color: rgb(68, 68, 68); font-size: 14px; line-height: 21px;"><font color="#001000" style="word-wrap: break-word;"><font style="word-wrap: break-word; font-size: 15px;"><span style="word-wrap: break-word; font-weight: 700;">; configuration for php seaslog module</span></font></font></font></li>\r\n     <li style="word-wrap: break-word; margin: 0px 0px 0px 2em; padding: 0px 0px 0px 10px; list-style-type: decimal-leading-zero; font-family: monaco, consolas, \'lucida console\', \'courier new\', serif; line-height: 1.8em;">\r\n       <font face="helvetica, arial, freesans, clean, sans-serif" style="word-wrap: break-word; color: rgb(68, 68, 68); font-size: 14px; line-height: 21px;"><font color="#001000" style="word-wrap: break-word;"><font style="word-wrap: break-word; font-size: 15px;"><span style="word-wrap: break-word; font-weight: 700;">extension = seaslog.so</span></font></font></font></li>\r\n     <li style="word-wrap: break-word; margin: 0px 0px 0px 2em; padding: 0px 0px 0px 10px; list-style-type: decimal-leading-zero; font-family: monaco, consolas, \'lucida console\', \'courier new\', serif; line-height: 1.8em;">\r\n       <font face="helvetica, arial, freesans, clean, sans-serif" style="word-wrap: break-word; color: rgb(68, 68, 68); font-size: 14px; line-height: 21px;"><font color="#001000" style="word-wrap: break-word;"><font style="word-wrap: break-word; font-size: 15px;"><span style="word-wrap: break-word; font-weight: 700;">seaslog.default_basepath = /log/seaslog-test&nbsp; &nbsp; ;默认log根目录</span></font></font></font></li>\r\n      <li style="word-wrap: break-word; margin: 0px 0px 0px 2em; padding: 0px 0px 0px 10px; list-style-type: decimal-leading-zero; font-family: monaco, consolas, \'lucida console\', \'courier new\', serif; line-height: 1.8em;">\r\n       <font face="helvetica, arial, freesans, clean, sans-serif" style="word-wrap: break-word; color: rgb(68, 68, 68); font-size: 14px; line-height: 21px;"><font color="#001000" style="word-wrap: break-word;"><font style="word-wrap: break-word; font-size: 15px;"><span style="word-wrap: break-word; font-weight: 700;">seaslog.default_logger = default&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp; ;默认logger目录</span></font></font></font></li>\r\n      <li style="word-wrap: break-word; margin: 0px 0px 0px 2em; padding: 0px 0px 0px 10px; list-style-type: decimal-leading-zero; font-family: monaco, consolas, \'lucida console\', \'courier new\', serif; line-height: 1.8em;">\r\n       <font face="helvetica, arial, freesans, clean, sans-serif" style="word-wrap: break-word; color: rgb(68, 68, 68); font-size: 14px; line-height: 21px;"><font color="#001000" style="word-wrap: break-word;"><font style="word-wrap: break-word; font-size: 15px;"><span style="word-wrap: break-word; font-weight: 700;">seaslog.disting_type = 1&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;;是否以type分文件 1是 0否(默认)</span></font></font></font></li>\r\n      <li style="word-wrap: break-word; margin: 0px 0px 0px 2em; padding: 0px 0px 0px 10px; list-style-type: decimal-leading-zero; font-family: monaco, consolas, \'lucida console\', \'courier new\', serif; line-height: 1.8em;">\r\n       <font face="helvetica, arial, freesans, clean, sans-serif" style="word-wrap: break-word; color: rgb(68, 68, 68); font-size: 14px; line-height: 21px;"><font color="#001000" style="word-wrap: break-word;"><font style="word-wrap: break-word; font-size: 15px;"><span style="word-wrap: break-word; font-weight: 700;">seaslog.disting_by_hour = 1&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;;是否每小时划分一个文件 1是 0否(默认)</span></font></font></font></li>\r\n     <li style="word-wrap: break-word; margin: 0px 0px 0px 2em; padding: 0px 0px 0px 10px; list-style-type: decimal-leading-zero; font-family: monaco, consolas, \'lucida console\', \'courier new\', serif; line-height: 1.8em;">\r\n       <font face="helvetica, arial, freesans, clean, sans-serif" style="word-wrap: break-word; color: rgb(68, 68, 68); font-size: 14px; line-height: 21px;"><font color="#001000" style="word-wrap: break-word;"><font style="word-wrap: break-word; font-size: 15px;"><span style="word-wrap: break-word; font-weight: 700;">seaslog.use_buffer = 1&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;;是否启用buffer 1是 0否(默认)</span></font></font></font></li>\r\n    </ol>\r\n </div>\r\n  <font face="helvetica, arial, freesans, clean, sans-serif" style="word-wrap: break-word; color: rgb(68, 68, 68); font-size: 14px; line-height: 21px;"><font color="#001000" style="word-wrap: break-word;"><font style="word-wrap: break-word; font-size: 15px;"><span style="word-wrap: break-word; font-weight: 700;"><span style="word-wrap: break-word; margin-left: 43px; font-size: 12px; cursor: pointer; color: rgb(30, 84, 127) !important;">复制代码</span></span></font></font></font></div>\r\n<p>\r\n  <br style="word-wrap: break-word;" />\r\n <br style="word-wrap: break-word;" />\r\n &nbsp;</p>\r\n<blockquote style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">\r\n <div align="left" style="word-wrap: break-word;">\r\n   seaslog.disting_type = 1 开启以type分文件，即log文件区分info\\warn\\erro</div>\r\n  <div align="left" style="word-wrap: break-word;">\r\n   seaslog.disting_by_hour = 1 开启每小时划分一个文件</div>\r\n <div align="left" style="word-wrap: break-word;">\r\n   seaslog.use_buffer = 1 开启buffer。默认关闭。当开启此项时，日志预存于内存，当请求结束时(或异常退出时)一次写入文件。</div>\r\n</blockquote>\r\n<p>\r\n <span style="word-wrap: break-word; font-weight: 700; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">使用</span><span style="word-wrap: break-word; font-weight: 700; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">常量与函数</span><span style="word-wrap: break-word; font-weight: 700; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">常量列表</span></p>\r\n<ul style="word-wrap: break-word; margin: 0px 0px 0px 14px; padding-right: 0px; padding-left: 0px; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">\r\n <li style="word-wrap: break-word; margin: 0px 0px 0px 2em; padding: 0px; list-style: disc;">\r\n    seaslog_type_info = 1</li>\r\n  <li style="word-wrap: break-word; margin: 0px 0px 0px 2em; padding: 0px; list-style: disc;">\r\n    seaslog_type_warn = 2</li>\r\n  <li style="word-wrap: break-word; margin: 0px 0px 0px 2em; padding: 0px; list-style: disc;">\r\n    seaslog_type_erro = 3</li>\r\n</ul>\r\n<p>\r\n  <font style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px; color: rgb(51, 51, 51);"><font face="helvetica, arial, freesans, clean, sans-serif" style="word-wrap: break-word;"><font style="word-wrap: break-word; font-size: 15px;"><font style="word-wrap: break-word; color: rgb(0, 134, 179);">var_dump</font>(seaslog_type_info,seaslog_type_warn,seaslog_type_erro);<font style="word-wrap: break-word; color: rgb(153, 153, 136);"><i style="word-wrap: break-word;">/*</i></font><font style="word-wrap: break-word; color: rgb(153, 153, 136);"><i style="word-wrap: break-word;">int(1) info类型</i></font><font style="word-wrap: break-word; color: rgb(153, 153, 136);"><i style="word-wrap: break-word;">int(2) warn类型</i></font><font style="word-wrap: break-word; color: rgb(153, 153, 136);"><i style="word-wrap: break-word;">int(3) erro类型</i></font><font style="word-wrap: break-word; color: rgb(153, 153, 136);"><i style="word-wrap: break-word;">*/</i></font></font></font></font><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <span style="word-wrap: break-word; font-weight: 700; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">函数列表</span></p>', NULL, 1444300876, -1062731039, 5, 0, 1, 0, 0, 0, 0, NULL, 0, NULL, 0);
INSERT INTO `details` (`id`, `first`, `tid`, `authorid`, `title`, `content`, `smiley`, `addtime`, `addip`, `classid`, `replycount`, `hits`, `istop`, `elite`, `ishot`, `rate`, `attachment`, `isdel`, `style`, `isdisplay`) VALUES
(4, 1, 0, 1, '深入理解php原理之对象(一)', '<table cellpadding="0" cellspacing="0" style="word-wrap: break-word; empty-cells: show; border-collapse: collapse; table-layout: fixed; width: 1141px; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; line-height: 18px;">\r\n  <tbody style="word-wrap: break-word;">\r\n    <tr style="word-wrap: break-word;">\r\n     <td class="t_f" id="postmessage_1530772" style="word-wrap: break-word; font-size: 14px;">\r\n       在php4以前, php并不支持面向对象, 到php4的时候, php引入了一些oop的关键字, 请注意我用的&rdquo;关键字&rdquo;, 因为在php4中的对象, 不过就是一个数组(属性)加上一个函数数组(方法), 没有访问权限控制, 没有析构函数, 等等.<br style="word-wrap: break-word;" />\r\n       到php5以后, 随着zend engine 2的发布:\r\n        <ul class="litype_1" style="word-wrap: break-word; margin: 0px 0px 0px 14px; padding-right: 0px; padding-left: 0px;" type="1">\r\n          <li style="word-wrap: break-word; margin: 0px 0px 0px 2em; padding: 0px; list-style: decimal;">\r\n           1. 访问权限控制</li>\r\n          <li style="word-wrap: break-word; margin: 0px 0px 0px 2em; padding: 0px; list-style: decimal;">\r\n           2. 接口的引入</li>\r\n         <li style="word-wrap: break-word; margin: 0px 0px 0px 2em; padding: 0px; list-style: decimal;">\r\n           3. 魔术方法</li>\r\n          <li style="word-wrap: break-word; margin: 0px 0px 0px 2em; padding: 0px; list-style: decimal;">\r\n           4. 接口的应用</li>\r\n         <li style="word-wrap: break-word; margin: 0px 0px 0px 2em; padding: 0px; list-style: decimal;">\r\n           5. 内置接口</li>\r\n          <li style="word-wrap: break-word; margin: 0px 0px 0px 2em; padding: 0px; list-style: decimal;">\r\n           等等</li>\r\n       </ul>\r\n       <br style="word-wrap: break-word;" />\r\n       php5终于可以算是较完美的支持面向对象了.<br style="word-wrap: break-word;" />\r\n       而这些看似复杂的实现, 在根本上, 还是没有脱离属性数组+方法数组的基本, 接下来我就为大家揭开隐藏在源代码中的秘密.<br style="word-wrap: break-word;" />\r\n        <span style="word-wrap: break-word; font-weight: 700;">对象的结构</span><br style="word-wrap: break-word;" />\r\n        在php5中, 一个对象, 还是以一个zval做为载体的, 还记得什么是zval么(<a class="gj_safe_a" href="http://www.laruence.com/2008/08/22/412.html" style="word-wrap: break-word; color: rgb(30, 84, 127);" target="_blank"><font color="#0000cc" style="word-wrap: break-word;">深入理解php原理之变量</font></a>).\r\n        <ul class="litype_1" style="word-wrap: break-word; margin: 0px 0px 0px 14px; padding-right: 0px; padding-left: 0px;" type="1">\r\n          <li style="word-wrap: break-word; margin: 0px 0px 0px 2em; padding: 0px; list-style: decimal;">\r\n           <font color="#96cbfe" style="word-wrap: break-word;">typedef</font>&nbsp;<font color="#96cbfe" style="word-wrap: break-word;">union</font>&nbsp;_zvalue_value {</li>\r\n          <li style="word-wrap: break-word; margin: 0px 0px 0px 2em; padding: 0px; list-style: decimal;">\r\n           &nbsp; &nbsp;&nbsp;<font color="#ffffb6" style="word-wrap: break-word;">long</font>&nbsp;lval;</li>\r\n         <li style="word-wrap: break-word; margin: 0px 0px 0px 2em; padding: 0px; list-style: decimal;">\r\n           &nbsp; &nbsp;&nbsp;<font color="#ffffb6" style="word-wrap: break-word;">double</font>&nbsp;dval;</li>\r\n         <li style="word-wrap: break-word; margin: 0px 0px 0px 2em; padding: 0px; list-style: decimal;">\r\n           &nbsp; &nbsp;&nbsp;<font color="#96cbfe" style="word-wrap: break-word;">struct</font>&nbsp;{</li>\r\n         <li style="word-wrap: break-word; margin: 0px 0px 0px 2em; padding: 0px; list-style: decimal;">\r\n           &nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;<font color="#ffffb6" style="word-wrap: break-word;">char</font>&nbsp;*val;</li>\r\n          <li style="word-wrap: break-word; margin: 0px 0px 0px 2em; padding: 0px; list-style: decimal;">\r\n           &nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;<font color="#ffffb6" style="word-wrap: break-word;">int</font>&nbsp;len;</li>\r\n          <li style="word-wrap: break-word; margin: 0px 0px 0px 2em; padding: 0px; list-style: decimal;">\r\n           &nbsp; &nbsp; } str;</li>\r\n         <li style="word-wrap: break-word; margin: 0px 0px 0px 2em; padding: 0px; list-style: decimal;">\r\n           &nbsp; &nbsp; hashtable<br style="word-wrap: break-word;" />\r\n            *ht;</li>\r\n         <li style="word-wrap: break-word; margin: 0px 0px 0px 2em; padding: 0px; list-style: decimal;">\r\n           &nbsp; &nbsp; zend_object_value<br style="word-wrap: break-word;" />\r\n            obj;</li>\r\n         <li style="word-wrap: break-word; margin: 0px 0px 0px 2em; padding: 0px; list-style: decimal;">\r\n           } zvalue_value;&lt;/span</li>\r\n       </ul>\r\n       <br style="word-wrap: break-word;" />\r\n       如果, 一个zval是对象, 那么zvalue_value中的obj, 就指向一个zend_object_value的实例.<br style="word-wrap: break-word;" />\r\n       一个zend_object_value包含俩个成员, 一个是标识符(整形序号), 表明了当前对象存储在全局对象列表的位置, 另外还有一个zend_object_handlers指针, 指向当前对象所属类的handlers(标准操作集合).<br style="word-wrap: break-word;" />\r\n        真正的对象实体, zend_object中, 保存了如下的关键信息入口:\r\n        <ul class="litype_1" style="word-wrap: break-word; margin: 0px 0px 0px 14px; padding-right: 0px; padding-left: 0px;" type="1">\r\n          <li style="word-wrap: break-word; margin: 0px 0px 0px 2em; padding: 0px; list-style: decimal;">\r\n           1. ce, zend_class_entry 类入口</li>\r\n          <li style="word-wrap: break-word; margin: 0px 0px 0px 2em; padding: 0px; list-style: decimal;">\r\n           2. properties, hashtable 普通属性</li>\r\n        </ul>\r\n       <br style="word-wrap: break-word;" />\r\n       <span style="word-wrap: break-word; font-weight: 700;">对象的属性</span><br style="word-wrap: break-word;" />\r\n        如上所述, 普通属性是一个的hashtable, 在php5以后, 引入了访问权限控制, 而访问权限属性, 是通过属性名进行区分的.\r\n        <ul class="litype_1" style="word-wrap: break-word; margin: 0px 0px 0px 14px; padding-right: 0px; padding-left: 0px;" type="1">\r\n          <li style="word-wrap: break-word; margin: 0px 0px 0px 2em; padding: 0px; list-style: decimal;">\r\n           1. public&nbsp;&nbsp;属性名</li>\r\n         <li style="word-wrap: break-word; margin: 0px 0px 0px 2em; padding: 0px; list-style: decimal;">\r\n           2. private \\0类名\\0属性名</li>\r\n         <li style="word-wrap: break-word; margin: 0px 0px 0px 2em; padding: 0px; list-style: decimal;">\r\n           3. protected \\0*\\0属性</li>\r\n       </ul>\r\n       <br style="word-wrap: break-word;" />\r\n       <br style="word-wrap: break-word;" />\r\n       php通过这种比较ugly但是简单高效的方法, 实现了对属性访问权限的标识.知道了这个, 我们就可以干一些不合常理的事请, 比如访问对象的私有/保护属性(见:&nbsp;<a class="gj_safe_a" href="http://bugs.php.net/bug.php?id=44273" style="word-wrap: break-word; color: rgb(30, 84, 127);" target="_blank"><font color="#0000cc" style="word-wrap: break-word;">bug #44273 access to private and protected class variables allowed when casting to array</font></a>):\r\n        <ul class="litype_1" style="word-wrap: break-word; margin: 0px 0px 0px 14px; padding-right: 0px; padding-left: 0px;" type="1">\r\n          <li style="word-wrap: break-word; margin: 0px 0px 0px 2em; padding: 0px; list-style: decimal;">\r\n           <font color="#96cbfe" style="word-wrap: break-word;">class</font>&nbsp;foo {</li>\r\n         <li style="word-wrap: break-word; margin: 0px 0px 0px 2em; padding: 0px; list-style: decimal;">\r\n           &nbsp; &nbsp; private&nbsp;<font color="#c6c5fe" style="word-wrap: break-word;">$_name</font>&nbsp;=&nbsp;<font color="#a8ff60" style="word-wrap: break-word;">&quot;laruence&quot;</font>;</li>\r\n          <li style="word-wrap: break-word; margin: 0px 0px 0px 2em; padding: 0px; list-style: decimal;">\r\n           &nbsp; &nbsp; protected&nbsp;<font color="#c6c5fe" style="word-wrap: break-word;">$_age</font>&nbsp;=&nbsp;<font color="#ff73fd" style="word-wrap: break-word;">28</font>;</li>\r\n         <li style="word-wrap: break-word; margin: 0px 0px 0px 2em; padding: 0px; list-style: decimal;">\r\n           }</li>\r\n          <li style="word-wrap: break-word; margin: 0px 0px 0px 2em; padding: 0px; list-style: decimal;">\r\n           <font color="#c6c5fe" style="word-wrap: break-word;">$foo</font>&nbsp;=&nbsp;<font color="#96cbfe" style="word-wrap: break-word;">new</font>&nbsp;<font color="#ffd2a7" style="word-wrap: break-word;">foo</font>();</li>\r\n         <li style="word-wrap: break-word; margin: 0px 0px 0px 2em; padding: 0px; list-style: decimal;">\r\n           <font color="#c6c5fe" style="word-wrap: break-word;">$arr</font>&nbsp;= (<font color="#96cbfe" style="word-wrap: break-word;">array</font>)&nbsp;<font color="#c6c5fe" style="word-wrap: break-word;">$foo</font>;</li>\r\n         <li style="word-wrap: break-word; margin: 0px 0px 0px 2em; padding: 0px; list-style: decimal;">\r\n           <font color="#ffd2a7" style="word-wrap: break-word;">var_dump</font>(<font color="#c6c5fe" style="word-wrap: break-word;">$arr</font>[<font color="#a8ff60" style="word-wrap: break-word;">&quot;\\0foo\\0_name&quot;</font>]);</li>\r\n          <li style="word-wrap: break-word; margin: 0px 0px 0px 2em; padding: 0px; list-style: decimal;">\r\n           <font color="#ffd2a7" style="word-wrap: break-word;">var_dump</font>(<font color="#c6c5fe" style="word-wrap: break-word;">$arr</font>[<font color="#a8ff60" style="word-wrap: break-word;">&quot;\\0*\\0_age&quot;</font>]);</li>\r\n         <li style="word-wrap: break-word; margin: 0px 0px 0px 2em; padding: 0px; list-style: decimal;">\r\n           <font color="#7c7c7c" style="word-wrap: break-word;">//output:</font></li>\r\n          <li style="word-wrap: break-word; margin: 0px 0px 0px 2em; padding: 0px; list-style: decimal;">\r\n           <font color="#ffd2a7" style="word-wrap: break-word;">string</font>(<font color="#ff73fd" style="word-wrap: break-word;">8</font>)&nbsp;<font color="#a8ff60" style="word-wrap: break-word;">&quot;laruence&quot;</font></li>\r\n          <li style="word-wrap: break-word; margin: 0px 0px 0px 2em; padding: 0px; list-style: decimal;">\r\n           <font color="#ffd2a7" style="word-wrap: break-word;">int</font>(<font color="#ff73fd" style="word-wrap: break-word;">28</font>)&lt;/span</li>\r\n       </ul>\r\n       <br style="word-wrap: break-word;" />\r\n       既然我说到了普通属性, 那么也就有不普通的属性:static/constant, 因为静态属性和常量属性都是和类相关而不是和对象相关的, 那么想到然的, 这些属性也就应该保存在类的结构中, 也就是zend_class_entry中. 对象的方法同理也是和类绑定的.在zend_class_entry, 有如下hashtable几个成员,\r\n        <ul class="litype_1" style="word-wrap: break-word; margin: 0px 0px 0px 14px; padding-right: 0px; padding-left: 0px;" type="1">\r\n          <li style="word-wrap: break-word; margin: 0px 0px 0px 2em; padding: 0px; list-style: decimal;">\r\n           1. function_table, 方法集</li>\r\n         <li style="word-wrap: break-word; margin: 0px 0px 0px 2em; padding: 0px; list-style: decimal;">\r\n           2. default_static_members, 静态属性</li>\r\n          <li style="word-wrap: break-word; margin: 0px 0px 0px 2em; padding: 0px; list-style: decimal;">\r\n           3. default_properties, 默认的属性</li>\r\n         <li style="word-wrap: break-word; margin: 0px 0px 0px 2em; padding: 0px; list-style: decimal;">\r\n           4. constants_table, 常量</li>\r\n       </ul>\r\n       <br style="word-wrap: break-word;" />\r\n       属性如其名, 对象类型的属性, 存放在对象的成员中.<br style="word-wrap: break-word;" />\r\n       <span style="word-wrap: break-word; font-weight: 700;">对象的方法</span><br style="word-wrap: break-word;" />\r\n        在zend_class_entry中的function_table是个hashtable, 这个函数表的结构和普通的函数表一样(<a class="gj_safe_a" href="http://www.laruence.com/2008/08/12/164.html" style="word-wrap: break-word; color: rgb(30, 84, 127);" target="_blank"><font color="#0000cc" style="word-wrap: break-word;">深入理解php之函数</font></a>), 也是以zend_op_array为最终载体, 所以和普通函数一样, 方法也是不区分大小写的, 也是可以附加arg_info的. 而不同的则是, 函数的访问权限则由zend_op_array的fn_flag属性表明.<br style="word-wrap: break-word;" />\r\n       我们知道, 在php内的函数, 都有统一的参数列表(遵守php函数约定开发的前提下),\r\n       <ul class="litype_1" style="word-wrap: break-word; margin: 0px 0px 0px 14px; padding-right: 0px; padding-left: 0px;" type="1">\r\n          <li style="word-wrap: break-word; margin: 0px 0px 0px 2em; padding: 0px; list-style: decimal;">\r\n           <font color="#ffd2a7" style="word-wrap: break-word;">#define</font>&nbsp;internal_function_param_passthru<br style="word-wrap: break-word;" />\r\n            ht, return_value, return_value_ptr, this_ptr, return_value_used<br style="word-wrap: break-word;" />\r\n            tsrmls_c</li>\r\n       </ul>\r\n       <br style="word-wrap: break-word;" />\r\n       在调用方法的时候, this关键字由函数参数中的this_ptr指明, 而对于用户定义的函数, this关键字则有zend vm保证.<br style="word-wrap: break-word;" />\r\n        说到这里, 举个列子:<br style="word-wrap: break-word;" />\r\n        如下代码, 会得到fatal\r\n        <ul class="litype_1" style="word-wrap: break-word; margin: 0px 0px 0px 14px; padding-right: 0px; padding-left: 0px;" type="1">\r\n          <li style="word-wrap: break-word; margin: 0px 0px 0px 2em; padding: 0px; list-style: decimal;">\r\n           &lt;?php</li>\r\n         <li style="word-wrap: break-word; margin: 0px 0px 0px 2em; padding: 0px; list-style: decimal;">\r\n           <font color="#96cbfe" style="word-wrap: break-word;">class</font>&nbsp;foo {</li>\r\n         <li style="word-wrap: break-word; margin: 0px 0px 0px 2em; padding: 0px; list-style: decimal;">\r\n           &nbsp; &nbsp;public&nbsp;<font color="#96cbfe" style="word-wrap: break-word;">function</font>&nbsp;<font color="#ffd2a7" style="word-wrap: break-word;">say</font>() {</li>\r\n         <li style="word-wrap: break-word; margin: 0px 0px 0px 2em; padding: 0px; list-style: decimal;">\r\n           &nbsp; &nbsp;&nbsp; &nbsp;<font color="#c6c5fe" style="word-wrap: break-word;">$this</font>&nbsp;= null;</li>\r\n         <li style="word-wrap: break-word; margin: 0px 0px 0px 2em; padding: 0px; list-style: decimal;">\r\n           &nbsp; &nbsp;}</li>\r\n         <li style="word-wrap: break-word; margin: 0px 0px 0px 2em; padding: 0px; list-style: decimal;">\r\n           }</li>\r\n          <li style="word-wrap: break-word; margin: 0px 0px 0px 2em; padding: 0px; list-style: decimal;">\r\n           ?&gt;</li>\r\n          <li style="word-wrap: break-word; margin: 0px 0px 0px 2em; padding: 0px; list-style: decimal;">\r\n           <font color="#7c7c7c" style="word-wrap: break-word;">//output:</font></li>\r\n          <li style="word-wrap: break-word; margin: 0px 0px 0px 2em; padding: 0px; list-style: decimal;">\r\n           php fatal error:&nbsp;&nbsp;cannot re-assign&nbsp;<font color="#c6c5fe" style="word-wrap: break-word;">$this</font>&nbsp;in **&lt;/span</li>\r\n        </ul>\r\n       <br style="word-wrap: break-word;" />\r\n       这是一个初级的保护措施, 防止this关键字被改写, 难道php就仅仅是做了这个保护? 不然, 让我们绕过这个保护措施看看, 如下:\r\n        <ul class="litype_1" style="word-wrap: break-word; margin: 0px 0px 0px 14px; padding-right: 0px; padding-left: 0px;" type="1">\r\n          <li style="word-wrap: break-word; margin: 0px 0px 0px 2em; padding: 0px; list-style: decimal;">\r\n           &lt;?php</li>\r\n         <li style="word-wrap: break-word; margin: 0px 0px 0px 2em; padding: 0px; list-style: decimal;">\r\n           <font color="#96cbfe" style="word-wrap: break-word;">class</font>&nbsp;foo {</li>\r\n         <li style="word-wrap: break-word; margin: 0px 0px 0px 2em; padding: 0px; list-style: decimal;">\r\n           &nbsp; &nbsp; public&nbsp;<font color="#c6c5fe" style="word-wrap: break-word;">$id</font>&nbsp;&nbsp;=&nbsp;<font color="#a8ff60" style="word-wrap: break-word;">&quot;laruence&quot;</font>;</li>\r\n          <li style="word-wrap: break-word; margin: 0px 0px 0px 2em; padding: 0px; list-style: decimal;">\r\n           &nbsp; &nbsp;&nbsp;<font color="#96cbfe" style="word-wrap: break-word;">function</font>&nbsp;<font color="#ffd2a7" style="word-wrap: break-word;">say</font>(<font color="#c6c5fe" style="word-wrap: break-word;">$arr</font>) {</li>\r\n         <li style="word-wrap: break-word; margin: 0px 0px 0px 2em; padding: 0px; list-style: decimal;">\r\n           &nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;<font color="#ffd2a7" style="word-wrap: break-word;">extract</font>(<font color="#c6c5fe" style="word-wrap: break-word;">$arr</font>, extr_overwrite);</li>\r\n         <li style="word-wrap: break-word; margin: 0px 0px 0px 2em; padding: 0px; list-style: decimal;">\r\n           &nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;<font color="#ffd2a7" style="word-wrap: break-word;">var_dump</font>(<font color="#c6c5fe" style="word-wrap: break-word;">$this</font>);</li>\r\n         <li style="word-wrap: break-word; margin: 0px 0px 0px 2em; padding: 0px; list-style: decimal;">\r\n           &nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;<font color="#ffd2a7" style="word-wrap: break-word;">var_dump</font>(<font color="#c6c5fe" style="word-wrap: break-word;">$this</font>-&gt;id);</li>\r\n          <li style="word-wrap: break-word; margin: 0px 0px 0px 2em; padding: 0px; list-style: decimal;">\r\n           &nbsp; &nbsp; }</li>\r\n          <li style="word-wrap: break-word; margin: 0px 0px 0px 2em; padding: 0px; list-style: decimal;">\r\n           }</li>\r\n          <li style="word-wrap: break-word; margin: 0px 0px 0px 2em; padding: 0px; list-style: decimal;">\r\n           <font color="#c6c5fe" style="word-wrap: break-word;">$a</font>&nbsp;=&nbsp;<font color="#96cbfe" style="word-wrap: break-word;">new</font>&nbsp;<font color="#ffd2a7" style="word-wrap: break-word;">foo</font>();</li>\r\n         <li style="word-wrap: break-word; margin: 0px 0px 0px 2em; padding: 0px; list-style: decimal;">\r\n           &nbsp;</li>\r\n         <li style="word-wrap: break-word; margin: 0px 0px 0px 2em; padding: 0px; list-style: decimal;">\r\n           <font color="#c6c5fe" style="word-wrap: break-word;">$a</font>-&gt;<font color="#ffd2a7" style="word-wrap: break-word;">say</font>(<font color="#96cbfe" style="word-wrap: break-word;">array</font>(<font color="#a8ff60" style="word-wrap: break-word;">&quot;this&quot;</font>&nbsp;=&gt; null));&nbsp;<font color="#7c7c7c" style="word-wrap: break-word;">//只是未来说明方法名不区分大小写.</font></li>\r\n         <li style="word-wrap: break-word; margin: 0px 0px 0px 2em; padding: 0px; list-style: decimal;">\r\n           ?&gt;</li>\r\n          <li style="word-wrap: break-word; margin: 0px 0px 0px 2em; padding: 0px; list-style: decimal;">\r\n           <font color="#7c7c7c" style="word-wrap: break-word;">//output:</font></li>\r\n          <li style="word-wrap: break-word; margin: 0px 0px 0px 2em; padding: 0px; list-style: decimal;">\r\n           null</li>\r\n         <li style="word-wrap: break-word; margin: 0px 0px 0px 2em; padding: 0px; list-style: decimal;">\r\n           <font color="#ffd2a7" style="word-wrap: break-word;">string</font>(<font color="#ff73fd" style="word-wrap: break-word;">8</font>)&nbsp;<font color="#a8ff60" style="word-wrap: break-word;">&quot;laruence&quot;&lt;/span</font></li>\r\n       </ul>\r\n       <br style="word-wrap: break-word;" />\r\n       可见this关键字, 并不是简单的符号表中的item. 是在语法分析阶段, 就由zend engine保证其正确性的, 并attach在函数的结构体中.<br style="word-wrap: break-word;" />\r\n       <span style="word-wrap: break-word; font-weight: 700;">对象的标准操作</span><br style="word-wrap: break-word;" />\r\n        我们对对象的操作, 比如获取属性, 设置属性, 获取对象的类, 等等, 这些常用的方法, 都是实现在对象的标准方法中的,php5中, 提供了23个标准方法.<br style="word-wrap: break-word;" />\r\n       在zend_object_value中的handlers指针, 就指向类常用操作的方法集合, 默认的, 这个指针指向:\r\n       <ul class="litype_1" style="word-wrap: break-word; margin: 0px 0px 0px 14px; padding-right: 0px; padding-left: 0px;" type="1">\r\n          <li style="word-wrap: break-word; margin: 0px 0px 0px 2em; padding: 0px; list-style: decimal;">\r\n           zend_api<br style="word-wrap: break-word;" />\r\n           zend_object_handlers<br style="word-wrap: break-word;" />\r\n           std_object_handlers = {</li>\r\n          <li style="word-wrap: break-word; margin: 0px 0px 0px 2em; padding: 0px; list-style: decimal;">\r\n           &nbsp; &nbsp; zend_objects_store_add_ref,&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;<font color="#7c7c7c" style="word-wrap: break-word;">/* add_ref */</font></li>\r\n         <li style="word-wrap: break-word; margin: 0px 0px 0px 2em; padding: 0px; list-style: decimal;">\r\n           &nbsp; &nbsp; zend_objects_store_del_ref,&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;<font color="#7c7c7c" style="word-wrap: break-word;">/* del_ref */</font></li>\r\n         <li style="word-wrap: break-word; margin: 0px 0px 0px 2em; padding: 0px; list-style: decimal;">\r\n           &nbsp; &nbsp; zend_objects_clone_obj,&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;<font color="#7c7c7c" style="word-wrap: break-word;">/* clone_obj */</font></li>\r\n          <li style="word-wrap: break-word; margin: 0px 0px 0px 2em; padding: 0px; list-style: decimal;">\r\n           &nbsp;</li>\r\n         <li style="word-wrap: break-word; margin: 0px 0px 0px 2em; padding: 0px; list-style: decimal;">\r\n           &nbsp; &nbsp; zend_std_read_property,&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;<font color="#7c7c7c" style="word-wrap: break-word;">/* read_property */</font></li>\r\n          <li style="word-wrap: break-word; margin: 0px 0px 0px 2em; padding: 0px; list-style: decimal;">\r\n           &nbsp; &nbsp; zend_std_write_property,&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;<font color="#7c7c7c" style="word-wrap: break-word;">/* write_property */</font></li>\r\n          <li style="word-wrap: break-word; margin: 0px 0px 0px 2em; padding: 0px; list-style: decimal;">\r\n           &nbsp; &nbsp; zend_std_read_dimension,&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;<font color="#7c7c7c" style="word-wrap: break-word;">/* read_dimension */</font></li>\r\n          <li style="word-wrap: break-word; margin: 0px 0px 0px 2em; padding: 0px; list-style: decimal;">\r\n           &nbsp; &nbsp; zend_std_write_dimension,&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;<font color="#7c7c7c" style="word-wrap: break-word;">/* write_dimension */</font></li>\r\n          <li style="word-wrap: break-word; margin: 0px 0px 0px 2em; padding: 0px; list-style: decimal;">\r\n           &nbsp; &nbsp; zend_std_get_property_ptr_ptr,&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;<font color="#7c7c7c" style="word-wrap: break-word;">/* get_property_ptr_ptr */</font></li>\r\n          <li style="word-wrap: break-word; margin: 0px 0px 0px 2em; padding: 0px; list-style: decimal;">\r\n           &nbsp; &nbsp; null,&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;<font color="#7c7c7c" style="word-wrap: break-word;">/* get */</font></li>\r\n          <li style="word-wrap: break-word; margin: 0px 0px 0px 2em; padding: 0px; list-style: decimal;">\r\n           &nbsp; &nbsp; null,&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;<font color="#7c7c7c" style="word-wrap: break-word;">/* set */</font></li>\r\n          <li style="word-wrap: break-word; margin: 0px 0px 0px 2em; padding: 0px; list-style: decimal;">\r\n           &nbsp; &nbsp; zend_std_has_property,&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;<font color="#7c7c7c" style="word-wrap: break-word;">/* has_property */</font></li>\r\n         <li style="word-wrap: break-word; margin: 0px 0px 0px 2em; padding: 0px; list-style: decimal;">\r\n           &nbsp; &nbsp; zend_std_unset_property,&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;<font color="#7c7c7c" style="word-wrap: break-word;">/* unset_property */</font></li>\r\n          <li style="word-wrap: break-word; margin: 0px 0px 0px 2em; padding: 0px; list-style: decimal;">\r\n           &nbsp; &nbsp; zend_std_has_dimension,&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;<font color="#7c7c7c" style="word-wrap: break-word;">/* has_dimension */</font></li>\r\n          <li style="word-wrap: break-word; margin: 0px 0px 0px 2em; padding: 0px; list-style: decimal;">\r\n           &nbsp; &nbsp; zend_std_unset_dimension,&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;<font color="#7c7c7c" style="word-wrap: break-word;">/* unset_dimension */</font></li>\r\n          <li style="word-wrap: break-word; margin: 0px 0px 0px 2em; padding: 0px; list-style: decimal;">\r\n           &nbsp; &nbsp; zend_std_get_properties,&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;<font color="#7c7c7c" style="word-wrap: break-word;">/* get_properties */</font></li>\r\n          <li style="word-wrap: break-word; margin: 0px 0px 0px 2em; padding: 0px; list-style: decimal;">\r\n           &nbsp; &nbsp; zend_std_get_method,&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;<font color="#7c7c7c" style="word-wrap: break-word;">/* get_method */</font></li>\r\n         <li style="word-wrap: break-word; margin: 0px 0px 0px 2em; padding: 0px; list-style: decimal;">\r\n           &nbsp; &nbsp; null,&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;<font color="#7c7c7c" style="word-wrap: break-word;">/* call_method */</font></li>\r\n          <li style="word-wrap: break-word; margin: 0px 0px 0px 2em; padding: 0px; list-style: decimal;">\r\n           &nbsp; &nbsp; zend_std_get_constructor,&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;<font color="#7c7c7c" style="word-wrap: break-word;">/* get_constructor */</font></li>\r\n          <li style="word-wrap: break-word; margin: 0px 0px 0px 2em; padding: 0px; list-style: decimal;">\r\n           &nbsp; &nbsp; zend_std_object_get_class,&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;<font color="#7c7c7c" style="word-wrap: break-word;">/* get_class_entry */</font></li>\r\n          <li style="word-wrap: break-word; margin: 0px 0px 0px 2em; padding: 0px; list-style: decimal;">\r\n           &nbsp; &nbsp; zend_std_object_get_class_name,&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;<font color="#7c7c7c" style="word-wrap: break-word;">/* get_class_name */</font></li>\r\n         <li style="word-wrap: break-word; margin: 0px 0px 0px 2em; padding: 0px; list-style: decimal;">\r\n           &nbsp; &nbsp; zend_std_compare_objects,&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;<font color="#7c7c7c" style="word-wrap: break-word;">/* compare_objects */</font></li>\r\n          <li style="word-wrap: break-word; margin: 0px 0px 0px 2em; padding: 0px; list-style: decimal;">\r\n           &nbsp; &nbsp; zend_std_cast_object_tostring,&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;<font color="#7c7c7c" style="word-wrap: break-word;">/* cast_object */</font></li>\r\n         <li style="word-wrap: break-word; margin: 0px 0px 0px 2em; padding: 0px; list-style: decimal;">\r\n           &nbsp; &nbsp; null,&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;<font color="#7c7c7c" style="word-wrap: break-word;">/* count_elements */</font></li>\r\n         <li style="word-wrap: break-word; margin: 0px 0px 0px 2em; padding: 0px; list-style: decimal;">\r\n           };&lt;/span</li>\r\n        </ul>\r\n       <br style="word-wrap: break-word;" />\r\n       默认的, 也是绝大多数的时候, 都是如上的这些标准方法.<br style="word-wrap: break-word;" />\r\n       需要指明的是, _dimension后缀的方法, 指的是通过数组($obj[&#39;name&#39;])方式访问对象的属性.<br style="word-wrap: break-word;" />\r\n       <span style="word-wrap: break-word; font-weight: 700;">魔术方法</span><br style="word-wrap: break-word;" />\r\n       魔术方法定义在class_entry中,\r\n        <ul class="litype_1" style="word-wrap: break-word; margin: 0px 0px 0px 14px; padding-right: 0px; padding-left: 0px;" type="1">\r\n          <li style="word-wrap: break-word; margin: 0px 0px 0px 2em; padding: 0px; list-style: decimal;">\r\n           union _zend_function *constructor;</li>\r\n         <li style="word-wrap: break-word; margin: 0px 0px 0px 2em; padding: 0px; list-style: decimal;">\r\n           union _zend_function *destructor;</li>\r\n          <li style="word-wrap: break-word; margin: 0px 0px 0px 2em; padding: 0px; list-style: decimal;">\r\n           union _zend_function *clone;</li>\r\n         <li style="word-wrap: break-word; margin: 0px 0px 0px 2em; padding: 0px; list-style: decimal;">\r\n           union _zend_function *__get;</li>\r\n         <li style="word-wrap: break-word; margin: 0px 0px 0px 2em; padding: 0px; list-style: decimal;">\r\n           union _zend_function *__set;</li>\r\n         <li style="word-wrap: break-word; margin: 0px 0px 0px 2em; padding: 0px; list-style: decimal;">\r\n           union _zend_function *__unset;</li>\r\n         <li style="word-wrap: break-word; margin: 0px 0px 0px 2em; padding: 0px; list-style: decimal;">\r\n           union _zend_function *__isset;</li>\r\n         <li style="word-wrap: break-word; margin: 0px 0px 0px 2em; padding: 0px; list-style: decimal;">\r\n           union _zend_function *__call;</li>\r\n          <li style="word-wrap: break-word; margin: 0px 0px 0px 2em; padding: 0px; list-style: decimal;">\r\n           union _zend_function *__tostring;</li>\r\n          <li style="word-wrap: break-word; margin: 0px 0px 0px 2em; padding: 0px; list-style: decimal;">\r\n           union _zend_function *serialize_func;</li>\r\n          <li style="word-wrap: break-word; margin: 0px 0px 0px 2em; padding: 0px; list-style: decimal;">\r\n           union _zend_function *unserialize_func;&lt;/span</li>\r\n       </ul>\r\n       <br style="word-wrap: break-word;" />\r\n       魔术方法没有默认值, 在类定义的时刻指定.<br style="word-wrap: break-word;" />\r\n        对于一些魔术方法, 比如__get/__set是被标准操作发起调用的, 所以如果我们自己编写扩展中定义的类, 如果不使用标准方法, 那么也需要在适当的时机, 主动调用这些魔术方法.<br />\r\n        &nbsp;</td>\r\n   </tr>\r\n </tbody>\r\n</table>\r\n<p>\r\n &nbsp;</p>', NULL, 1444300955, -1062731039, 5, 0, 1, 0, 0, 0, 0, NULL, 0, NULL, 0);
INSERT INTO `details` (`id`, `first`, `tid`, `authorid`, `title`, `content`, `smiley`, `addtime`, `addip`, `classid`, `replycount`, `hits`, `istop`, `elite`, `ishot`, `rate`, `attachment`, `isdel`, `style`, `isdisplay`) VALUES
(5, 1, 0, 1, '深入理解zend sapis(zend sapi internals)', '<p>\r\n  <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&middot; 作者:laruence(</span><a href="http://www.laruence.com/" style="word-wrap: break-word; color: rgb(30, 84, 127); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" target="_blank">http://www.laruence.com/)</a><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&middot; 本文地址:&nbsp;</span><a href="http://www.laruence.com/2008/08/12/180.html" style="word-wrap: break-word; color: rgb(30, 84, 127); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" target="_blank">http://www.laruence.com/2008/08/12/180.html</a><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&middot; 转载请注明出处&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;sapi:server abstractionapi，研究过php架构的同学应该知道这个东东的重要性，它提供了一个接口，使得php可以和其他应用进行交互数据。本文不会详细介绍每个php的sapi，只是针对最简单的cgi sapi，来说明sapi的机制。</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">首先，我们来看看php的架构图：</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <a href="http://www.laruence.com/wp-content/uploads/php-arch.jpg" style="word-wrap: break-word; color: rgb(30, 84, 127); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" target="_blank"><img alt="" border="0" class="zoom" file="http://www.laruence.com/wp-content/uploads/php-arch-293x300.jpg" height="300" id="aimg_n285e" lazyloaded="true" src="http://www.laruence.com/wp-content/uploads/php-arch-293x300.jpg" style="word-wrap: break-word; border: none; cursor: pointer;" width="293" /></a><span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">php架构图</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">图1 php architecture</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">sapi提供了一个和外部通信的接口，对于php5.2，默认提供了很多种sapi，常见的给apache的mod_php5，cgi，给iis的isapi，还有shell的cli，本文就从cgi sapi入手，介绍sapi的机制。 虽然cgi简单，但是不用担心，它包含了绝大部分内容，足以让你深刻理解sapi的工作原理。要定义个sapi，首先要定义个sapi_module_struct,&nbsp;&nbsp;查看 php-src/sapi/cgi/cgi_main.c:</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <font color="gray" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">*/</font><br style="word-wrap: break-word;" />\r\n  <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">static</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">sapi_module_struct</font><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">cgi_sapi_module</font><font color="gray" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp;=&nbsp;</font><font color="olive" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">{</font><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">#if</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">php_fastcgi</font><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <font color="#8b0000" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&quot;</font><font color="red" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">cgi-fcgi</font><font color="#8b0000" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&quot;</font><font color="gray" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">,&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;</font><span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">/* name */</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <font color="#8b0000" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&quot;</font><font color="red" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">cgi/fastcgi</font><font color="#8b0000" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&quot;</font><font color="gray" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">,&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;</font><span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">/* pretty name */</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">#else</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <font color="#8b0000" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&quot;</font><font color="red" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">cgi</font><font color="#8b0000" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&quot;</font><font color="gray" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">,&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;</font><span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">/* name */</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <font color="#8b0000" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&quot;</font><font color="red" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">cgi</font><font color="#8b0000" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&quot;</font><font color="gray" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">,&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;</font><span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">/* pretty name */</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">#endif</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">php_cgi_startup</font><font color="gray" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">,&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;</font><span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">/* startup */</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">php_module_shutdown_wrapper</font><font color="gray" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">,&nbsp; &nbsp;&nbsp;</font><span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">/* shutdown */</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">null</span><font color="gray" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">,&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;</font><span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">/* activate */</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">sapi_cgi_deactivate</font><font color="gray" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">,&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;</font><span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">/* deactivate */</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">sapi_cgibin_ub_write</font><font color="gray" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">,&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;</font><span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">/* unbuffered write */</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">sapi_cgibin_flush</font><font color="gray" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">,&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;</font><span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">/* flush */</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">null</span><font color="gray" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">,&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;</font><span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">/* get uid */</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">sapi_cgibin_getenv</font><font color="gray" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">,&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;</font><span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">/* getenv */</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">php_error</font><font color="gray" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">,&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;</font><span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">/* error handler */</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">null</span><font color="gray" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">,&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;</font><span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">/* header handler */</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">sapi_cgi_send_headers</font><font color="gray" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">,&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;</font><span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">/* send headers handler */</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">null</span><font color="gray" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">,&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;</font><span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">/* send header handler */</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">sapi_cgi_read_post</font><font color="gray" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">,&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;</font><span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">/* read post data */</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">sapi_cgi_read_cookies</font><font color="gray" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">,&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;</font><span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">/* read cookies */</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">sapi_cgi_register_variables</font><font color="gray" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">,&nbsp; &nbsp;&nbsp;</font><span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">/* register server variables */</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">sapi_cgi_log_message</font><font color="gray" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">,&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;</font><span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">/* log message */</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">null</span><font color="gray" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">,&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;</font><span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">/* get request time */</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">standard_sapi_module_properties</font><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <font color="olive" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">}</font><font color="gray" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">;</font><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp; 这个结构，包含了一些常量，比如name, 这个会在我们调用php_info()的时候被使用。一些初始化，收尾函数，以及一些函数指针，用来告诉zend，如何获取，和输出数据。</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">1. php_cgi_startup， 当一个应用要调用php的时候，这个函数会被调用，对于cgi来说，它只是简单的调用了php的初始化函数：static</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">int</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">php_cgi_startup</font><font color="olive" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">(</font><font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">sapi_module_struct</font><font color="gray" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp;*</font><font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">sapi_module</font><font color="olive" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">)</font><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <font color="olive" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">{</font><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <font color="green" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">if</font><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <font color="olive" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">(</font><font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">php_module_startup</font><font color="olive" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">(</font><font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">sapi_module</font><font color="gray" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">,&nbsp;</font><span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">null</span><font color="gray" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">,&nbsp;</font><font color="maroon" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">0</font><font color="olive" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">)</font><font color="gray" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp;==&nbsp;</font><font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">failure</font><font color="olive" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">)</font><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <font color="olive" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">{</font><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <font color="green" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">return</font><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">failure</font><font color="gray" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">;<br style="word-wrap: break-word;" />\r\n  &nbsp; &nbsp;&nbsp;</font><font color="olive" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">}</font><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <font color="green" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">return</font><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">success</font><font color="gray" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">;</font><br style="word-wrap: break-word;" />\r\n <font color="olive" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">}</font><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">2. php_module_shutdown_wrapper ， 一个对php关闭函数的简单包装。只是简单的调用php_module_shutdown;3.php会在每个request的时候，处理一些初始化，资源分配的事务。这部分就是activate字段要定义的，从上面的结构我们可以看出，对于cgi来说，它并没有提供初始化处理句柄。对于mod_php来说，那就不同了，他要在apache的pool中注册资源析构函数， 申请空间，初始化环境变量，等等等等。4. sapi_cgi_deactivate, 这个是对应与activate的函数，顾名思义，它会提供一个handler, 用来处理收尾工作，对于cgi来说，他只是简单的刷新缓冲区，用以保证用户在zend关闭前得到所有的输出数据：</span><font color="green" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">static</font><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">int</font><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">sapi_cgi_deactivate</font><font color="olive" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">(</font><font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">tsrmls_d</font><font color="olive" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">)</font><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <font color="olive" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">{</font><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <font color="#ffa500" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">/* flush only when sapi was started. the reasons are:<br style="word-wrap: break-word;" />\r\n &nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;1. sapi deactivate is called from two places: module init and request shutdown<br style="word-wrap: break-word;" />\r\n &nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;2. when the first call occurs and the request is not set up, flush fails on<br style="word-wrap: break-word;" />\r\n  &nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;fastcgi.<br style="word-wrap: break-word;" />\r\n &nbsp; &nbsp; */</font><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <font color="green" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">if</font><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <font color="olive" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">(</font><font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">sg</font><font color="olive" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">(</font><font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">sapi_started</font><font color="olive" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">))</font><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <font color="olive" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">{</font><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">sapi_cgibin_flush</font><font color="olive" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">(</font><font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">sg</font><font color="olive" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">(</font><font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">server_context</font><font color="olive" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">))</font><font color="gray" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">;<br style="word-wrap: break-word;" />\r\n  &nbsp; &nbsp;&nbsp;</font><font color="olive" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">}</font><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <font color="green" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">return</font><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">success</font><font color="gray" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">;</font><br style="word-wrap: break-word;" />\r\n <font color="olive" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">}</font><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">5. sapi_cgibin_ub_write, 这个hanlder告诉了zend，如何输出数据，对于mod_php来说，这个函数提供了一个向response数据写的接口，而对于cgi来说，只是简单的写到stdout：</span><font color="green" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">static</font><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">inline</font><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">size_t</font><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">sapi_cgibin_single_write</font><font color="olive" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">(</font><font color="green" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">const</font><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">char</font><font color="gray" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp;*</font><font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">str</font><font color="gray" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">,&nbsp;</font><font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">uint</font><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">str_length</font><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">tsrmls_dc</font><font color="olive" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">)</font><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <font color="olive" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">{</font><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <font color="#ffa500" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">#ifdef php_write_stdout</font><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">long</font><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">ret</font><font color="gray" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">;</font><br style="word-wrap: break-word;" />\r\n <font color="#ffa500" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">#else</font><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">size_t</font><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">ret</font><font color="gray" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">;</font><br style="word-wrap: break-word;" />\r\n <font color="#ffa500" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">#endif</font><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <font color="#ffa500" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">#if php_fastcgi</font><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <font color="green" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">if</font><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <font color="olive" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">(</font><font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">fcgi_is_fastcgi</font><font color="olive" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">())</font><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <font color="olive" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">{</font><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">fcgi_request</font><font color="gray" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp;*</font><font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">request</font><font color="gray" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp;=&nbsp;</font><font color="olive" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">(</font><font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">fcgi_request</font><font color="gray" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">*</font><font color="olive" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">)</font><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">sg</font><font color="olive" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">(</font><font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">server_context</font><font color="olive" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">)</font><font color="gray" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">;<br style="word-wrap: break-word;" />\r\n  &nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;</font><font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">long</font><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">ret</font><font color="gray" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp;=&nbsp;</font><font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">fcgi_write</font><font color="olive" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">(</font><font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">request</font><font color="gray" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">,&nbsp;</font><font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">fcgi_stdout</font><font color="gray" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">,&nbsp;</font><font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">str</font><font color="gray" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">,&nbsp;</font><font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">str_length</font><font color="olive" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">)</font><font color="gray" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">;<br style="word-wrap: break-word;" />\r\n  &nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;</font><font color="green" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">if</font><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <font color="olive" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">(</font><font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">ret</font><font color="gray" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp;&lt;=&nbsp;</font><font color="maroon" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">0</font><font color="olive" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">)</font><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <font color="olive" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">{</font><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <font color="green" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">return</font><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <font color="maroon" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">0</font><font color="gray" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">;<br style="word-wrap: break-word;" />\r\n  &nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;</font><font color="olive" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">}</font><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <font color="green" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">return</font><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">ret</font><font color="gray" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">;<br style="word-wrap: break-word;" />\r\n  &nbsp; &nbsp;&nbsp;</font><font color="olive" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">}</font><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <font color="#ffa500" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">#endif</font><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <font color="#ffa500" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">#ifdef php_write_stdout</font><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">ret</font><font color="gray" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp;=&nbsp;</font><font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">write</font><font color="olive" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">(</font><font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">stdout_fileno</font><font color="gray" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">,&nbsp;</font><font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">str</font><font color="gray" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">,&nbsp;</font><font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">str_length</font><font color="olive" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">)</font><font color="gray" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">;<br style="word-wrap: break-word;" />\r\n &nbsp; &nbsp;&nbsp;</font><font color="green" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">if</font><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <font color="olive" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">(</font><font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">ret</font><font color="gray" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp;&lt;=&nbsp;</font><font color="maroon" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">0</font><font color="olive" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">)</font><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <font color="green" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">return</font><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <font color="maroon" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">0</font><font color="gray" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">;<br style="word-wrap: break-word;" />\r\n  &nbsp; &nbsp;&nbsp;</font><font color="green" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">return</font><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">ret</font><font color="gray" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">;</font><br style="word-wrap: break-word;" />\r\n <font color="#ffa500" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">#else</font><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">ret</font><font color="gray" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp;=&nbsp;</font><font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">fwrite</font><font color="olive" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">(</font><font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">str</font><font color="gray" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">,&nbsp;</font><font color="maroon" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">1</font><font color="gray" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">,&nbsp;</font><font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">min</font><font color="olive" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">(</font><font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">str_length</font><font color="gray" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">,&nbsp;</font><font color="maroon" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">16384</font><font color="olive" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">)</font><font color="gray" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">,&nbsp;</font><font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">stdout</font><font color="olive" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">)</font><font color="gray" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">;<br style="word-wrap: break-word;" />\r\n &nbsp; &nbsp;&nbsp;</font><font color="green" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">return</font><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">ret</font><font color="gray" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">;</font><br style="word-wrap: break-word;" />\r\n <font color="#ffa500" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">#endif</font><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <font color="olive" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">}</font><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <font color="green" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">static</font><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">int</font><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">sapi_cgibin_ub_write</font><font color="olive" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">(</font><font color="green" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">const</font><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">char</font><font color="gray" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp;*</font><font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">str</font><font color="gray" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">,&nbsp;</font><font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">uint</font><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">str_length</font><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">tsrmls_dc</font><font color="olive" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">)</font><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <font color="olive" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">{</font><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <font color="green" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">const</font><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">char</font><font color="gray" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp;*</font><font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">ptr</font><font color="gray" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp;=&nbsp;</font><font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">str</font><font color="gray" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">;<br style="word-wrap: break-word;" />\r\n &nbsp; &nbsp;&nbsp;</font><font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">uint</font><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">remaining</font><font color="gray" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp;=&nbsp;</font><font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">str_length</font><font color="gray" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">;<br style="word-wrap: break-word;" />\r\n &nbsp; &nbsp;&nbsp;</font><font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">size_t</font><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">ret</font><font color="gray" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">;<br style="word-wrap: break-word;" />\r\n  <br style="word-wrap: break-word;" />\r\n &nbsp; &nbsp;&nbsp;</font><font color="green" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">while</font><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <font color="olive" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">(</font><font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">remaining</font><font color="gray" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp;&gt;&nbsp;</font><font color="maroon" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">0</font><font color="olive" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">)</font><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <font color="olive" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">{</font><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">ret</font><font color="gray" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp;=&nbsp;</font><font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">sapi_cgibin_single_write</font><font color="olive" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">(</font><font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">ptr</font><font color="gray" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">,&nbsp;</font><font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">remaining</font><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">tsrmls_cc</font><font color="olive" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">)</font><font color="gray" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">;<br style="word-wrap: break-word;" />\r\n &nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;</font><font color="green" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">if</font><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <font color="olive" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">(</font><font color="gray" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">!</font><font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">ret</font><font color="olive" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">)</font><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <font color="olive" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">{</font><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">php_handle_aborted_connection</font><font color="olive" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">()</font><font color="gray" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">;<br style="word-wrap: break-word;" />\r\n  &nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;</font><font color="green" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">return</font><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">str_length</font><font color="gray" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp;-&nbsp;</font><font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">remaining</font><font color="gray" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">;<br style="word-wrap: break-word;" />\r\n &nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;</font><font color="olive" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">}</font><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">ptr</font><font color="gray" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp;+=&nbsp;</font><font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">ret</font><font color="gray" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">;<br style="word-wrap: break-word;" />\r\n &nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;</font><font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">remaining</font><font color="gray" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp;-=&nbsp;</font><font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">ret</font><font color="gray" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">;<br style="word-wrap: break-word;" />\r\n  &nbsp; &nbsp;&nbsp;</font><font color="olive" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">}</font><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <font color="green" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">return</font><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">str_length</font><font color="gray" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">;</font><br style="word-wrap: break-word;" />\r\n  <font color="olive" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">}</font><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">把真正的写的逻辑剥离出来，就是为了简单实现兼容fastcgi的写方式。&nbsp;</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">6. sapi_cgibin_flush, 这个是提供给zend的刷新缓存的函数句柄，对于cgi来说，只是简单的调用系统提供的fflush;7.null， 这部分用来让zend可以验证一个要执行脚本文件的state，从而判断文件是否据有执行权限等等，cgi没有提供。8. sapi_cgibin_getenv,为zend提供了一个根据name来查找环境变量的接口，对于mod_php5来说，当我们在脚本中调用getenv的时候，就会间接的调用这个句柄。而对于cgi来说，因为他的运行机制和cli很类似，直接调用父级是shell， 所以，只是简单的调用了系统提供的genenv:</span><font color="green" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">static</font><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">char</font><font color="gray" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp;*</font><font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">sapi_cgibin_getenv</font><font color="olive" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">(</font><font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">char</font><font color="gray" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp;*</font><font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">name</font><font color="gray" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">,&nbsp;</font><font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">size_t</font><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">name_len</font><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">tsrmls_dc</font><font color="olive" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">)</font><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <font color="olive" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">{</font><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <font color="#ffa500" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">#if php_fastcgi</font><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <font color="#ffa500" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">/* when php is started by mod_fastcgi, no regular environment<br style="word-wrap: break-word;" />\r\n &nbsp; &nbsp;&nbsp; &nbsp; is provided to php.&nbsp;&nbsp;it is always sent to php at the start<br style="word-wrap: break-word;" />\r\n  &nbsp; &nbsp;&nbsp; &nbsp; of a request.&nbsp;&nbsp;so we have to do our own lookup to get env<br style="word-wrap: break-word;" />\r\n &nbsp; &nbsp;&nbsp; &nbsp; vars.&nbsp;&nbsp;this could probably be faster somehow.&nbsp;&nbsp;*/</font><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <font color="green" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">if</font><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <font color="olive" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">(</font><font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">fcgi_is_fastcgi</font><font color="olive" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">())</font><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <font color="olive" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">{</font><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">fcgi_request</font><font color="gray" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp;*</font><font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">request</font><font color="gray" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp;=&nbsp;</font><font color="olive" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">(</font><font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">fcgi_request</font><font color="gray" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">*</font><font color="olive" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">)</font><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">sg</font><font color="olive" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">(</font><font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">server_context</font><font color="olive" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">)</font><font color="gray" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">;<br style="word-wrap: break-word;" />\r\n  &nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;</font><font color="green" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">return</font><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">fcgi_getenv</font><font color="olive" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">(</font><font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">request</font><font color="gray" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">,&nbsp;</font><font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">name</font><font color="gray" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">,&nbsp;</font><font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">name_len</font><font color="olive" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">)</font><font color="gray" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">;<br style="word-wrap: break-word;" />\r\n  &nbsp; &nbsp;&nbsp;</font><font color="olive" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">}</font><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <font color="#ffa500" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">#endif</font><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <font color="#ffa500" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">/*&nbsp;&nbsp;if cgi, or fastcgi and not found in fcgi env<br style="word-wrap: break-word;" />\r\n  &nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;check the regular environment */</font><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <font color="green" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">return</font><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">getenv</font><font color="olive" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">(</font><font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">name</font><font color="olive" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">)</font><font color="gray" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">;</font><br style="word-wrap: break-word;" />\r\n <font color="olive" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">}</font><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">9. php_error, 错误处理函数, 到这里，说几句题外话，上次看到php maillist提到的使得php的错误处理机制完全oo化，也就是，改写这个函数句柄，使得每当有错误发生的时候，都throw一个异常。而cgi只是简单的调用了php提供的错误处理函数。10. 这个函数会在我们调用php的header()函数的时候被调用，对于cgi来说，不提供。11. sapi_cgi_send_headers,&nbsp;&nbsp;这个函数会在要真正发送header的时候被调用，一般来说，就是当有任何的输出要发送之前：</span><font color="green" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">static</font><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">int</font><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">sapi_cgi_send_headers</font><font color="olive" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">(</font><font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">sapi_headers_struct</font><font color="gray" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp;*</font><font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">sapi_headers</font><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">tsrmls_dc</font><font color="olive" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">)</font><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <font color="olive" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">{</font><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">char</font><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">buf</font><font color="olive" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">[</font><font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">sapi_cgi_max_header_length</font><font color="olive" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">]</font><font color="gray" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">;<br style="word-wrap: break-word;" />\r\n &nbsp; &nbsp;&nbsp;</font><font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">sapi_header_struct</font><font color="gray" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp;*</font><font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">h</font><font color="gray" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">;<br style="word-wrap: break-word;" />\r\n &nbsp; &nbsp;&nbsp;</font><font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">zend_llist_position</font><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">pos</font><font color="gray" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">;<br style="word-wrap: break-word;" />\r\n  <br style="word-wrap: break-word;" />\r\n &nbsp; &nbsp;&nbsp;</font><font color="green" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">if</font><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <font color="olive" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">(</font><font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">sg</font><font color="olive" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">(</font><font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">request_info</font><font color="olive" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">)</font><font color="gray" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">.</font><font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">no_headers</font><font color="gray" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp;==&nbsp;</font><font color="maroon" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">1</font><font color="olive" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">)</font><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <font color="olive" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">{</font><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <font color="green" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">return</font><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">sapi_header_sent_successfully</font><font color="gray" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">;<br style="word-wrap: break-word;" />\r\n  &nbsp; &nbsp;&nbsp;</font><font color="olive" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">}</font><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <font color="green" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">if</font><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <font color="olive" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">(</font><font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">cgi_nph</font><font color="gray" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp;||&nbsp;</font><font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">sg</font><font color="olive" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">(</font><font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">sapi_headers</font><font color="olive" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">)</font><font color="gray" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">.</font><font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">http_response_code</font><font color="gray" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp;!=&nbsp;</font><font color="maroon" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">200</font><font color="olive" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">)</font><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <font color="olive" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">{</font><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">int</font><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">len</font><font color="gray" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">;<br style="word-wrap: break-word;" />\r\n  <br style="word-wrap: break-word;" />\r\n &nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;</font><font color="green" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">if</font><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <font color="olive" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">(</font><font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">rfc2616_headers</font><font color="gray" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp;&amp;&amp;&nbsp;</font><font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">sg</font><font color="olive" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">(</font><font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">sapi_headers</font><font color="olive" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">)</font><font color="gray" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">.</font><font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">http_status_line</font><font color="olive" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">)</font><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <font color="olive" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">{</font><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">len</font><font color="gray" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp;=&nbsp;</font><font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">snprintf</font><font color="olive" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">(</font><font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">buf</font><font color="gray" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">,&nbsp;</font><font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">sapi_cgi_max_header_length</font><font color="gray" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">,<br style="word-wrap: break-word;" />\r\n &nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;</font><font color="#8b0000" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&quot;</font><font color="red" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">%s</font><font color="navy" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">\\r\\n</font><font color="#8b0000" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&quot;</font><font color="gray" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">,&nbsp;</font><font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">sg</font><font color="olive" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">(</font><font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">sapi_headers</font><font color="olive" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">)</font><font color="gray" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">.</font><font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">http_status_line</font><font color="olive" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">)</font><font color="gray" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">;<br style="word-wrap: break-word;" />\r\n <br style="word-wrap: break-word;" />\r\n &nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;</font><font color="green" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">if</font><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <font color="olive" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">(</font><font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">len</font><font color="gray" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp;&gt;&nbsp;</font><font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">sapi_cgi_max_header_length</font><font color="olive" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">)</font><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <font color="olive" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">{</font><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">len</font><font color="gray" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp;=&nbsp;</font><font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">sapi_cgi_max_header_length</font><font color="gray" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">;<br style="word-wrap: break-word;" />\r\n &nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;</font><font color="olive" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">}</font><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <font color="olive" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">}</font><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <font color="green" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">else</font><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <font color="olive" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">{</font><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">len</font><font color="gray" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp;=&nbsp;</font><font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">sprintf</font><font color="olive" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">(</font><font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">buf</font><font color="gray" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">,&nbsp;</font><font color="#8b0000" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&quot;</font><font color="red" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">status: %d</font><font color="navy" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">\\r\\n</font><font color="#8b0000" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&quot;</font><font color="gray" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">,&nbsp;</font><font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">sg</font><font color="olive" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">(</font><font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">sapi_headers</font><font color="olive" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">)</font><font color="gray" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">.</font><font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">http_response_code</font><font color="olive" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">)</font><font color="gray" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">;<br style="word-wrap: break-word;" />\r\n  &nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;</font><font color="olive" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">}</font><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">phpwrite_h</font><font color="olive" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">(</font><font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">buf</font><font color="gray" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">,&nbsp;</font><font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">len</font><font color="olive" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">)</font><font color="gray" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">;<br style="word-wrap: break-word;" />\r\n &nbsp; &nbsp;&nbsp;</font><font color="olive" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">}</font><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">h</font><font color="gray" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp;=&nbsp;</font><font color="olive" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">(</font><font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">sapi_header_struct</font><font color="gray" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">*</font><font color="olive" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">)</font><font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">zend_llist_get_first_ex</font><font color="olive" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">(</font><font color="gray" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&amp;</font><font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">sapi_headers</font><font color="gray" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">-&gt;</font><font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">headers</font><font color="gray" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">, &amp;</font><font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">pos</font><font color="olive" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">)</font><font color="gray" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">;<br style="word-wrap: break-word;" />\r\n  &nbsp; &nbsp;&nbsp;</font><font color="green" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">while</font><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <font color="olive" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">(</font><font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">h</font><font color="olive" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">)</font><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <font color="olive" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">{</font><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <font color="#ffa500" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">/* prevent crlfcrlf */</font><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <font color="green" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">if</font><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <font color="olive" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">(</font><font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">h</font><font color="gray" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">-&gt;</font><font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">header_len</font><font color="olive" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">)</font><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <font color="olive" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">{</font><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">phpwrite_h</font><font color="olive" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">(</font><font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">h</font><font color="gray" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">-&gt;</font><font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">header</font><font color="gray" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">,&nbsp;</font><font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">h</font><font color="gray" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">-&gt;</font><font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">header_len</font><font color="olive" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">)</font><font color="gray" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">;<br style="word-wrap: break-word;" />\r\n &nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;</font><font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">phpwrite_h</font><font color="olive" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">(</font><font color="#8b0000" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&quot;</font><font color="navy" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">\\r\\n</font><font color="#8b0000" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&quot;</font><font color="gray" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">,&nbsp;</font><font color="maroon" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">2</font><font color="olive" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">)</font><font color="gray" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">;<br style="word-wrap: break-word;" />\r\n &nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;</font><font color="olive" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">}</font><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">h</font><font color="gray" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp;=&nbsp;</font><font color="olive" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">(</font><font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">sapi_header_struct</font><font color="gray" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">*</font><font color="olive" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">)</font><font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">zend_llist_get_next_ex</font><font color="olive" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">(</font><font color="gray" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&amp;</font><font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">sapi_headers</font><font color="gray" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">-&gt;</font><font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">headers</font><font color="gray" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">, &amp;</font><font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">pos</font><font color="olive" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">)</font><font color="gray" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">;<br style="word-wrap: break-word;" />\r\n &nbsp; &nbsp;&nbsp;</font><font color="olive" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">}</font><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">phpwrite_h</font><font color="olive" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">(</font><font color="#8b0000" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&quot;</font><font color="navy" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">\\r\\n</font><font color="#8b0000" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&quot;</font><font color="gray" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">,&nbsp;</font><font color="maroon" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">2</font><font color="olive" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">)</font><font color="gray" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">;<br style="word-wrap: break-word;" />\r\n  <br style="word-wrap: break-word;" />\r\n &nbsp; &nbsp;&nbsp;</font><font color="green" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">return</font><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">sapi_header_sent_successfully</font><font color="gray" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">;<br style="word-wrap: break-word;" />\r\n  &nbsp; &nbsp;</font><font color="olive" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">}</font><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">12. null, 这个用来单独发送每一个header, cgi没有提供 13. sapi_cgi_read_post, 这个句柄指明了如何获取post的数据，如果做过cgi编程的话，我们就知道cgi是从stdin中读取post data的，</span><font color="green" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">static</font><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">int</font><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">sapi_cgi_read_post</font><font color="olive" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">(</font><font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">char</font><font color="gray" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp;*</font><font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">buffer</font><font color="gray" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">,&nbsp;</font><font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">uint</font><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">count_bytes</font><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">tsrmls_dc</font><font color="olive" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">)</font><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <font color="olive" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">{</font><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">uint</font><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">read_bytes</font><font color="gray" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">=</font><font color="maroon" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">0</font><font color="gray" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">,&nbsp;</font><font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">tmp_read_bytes</font><font color="gray" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">;</font><br style="word-wrap: break-word;" />\r\n <font color="#ffa500" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">#if php_fastcgi</font><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">char</font><font color="gray" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp;*</font><font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">pos</font><font color="gray" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp;=&nbsp;</font><font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">buffer</font><font color="gray" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">;</font><br style="word-wrap: break-word;" />\r\n <font color="#ffa500" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">#endif</font><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">count_bytes</font><font color="gray" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp;=&nbsp;</font><font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">min</font><font color="olive" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">(</font><font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">count_bytes</font><font color="gray" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">,&nbsp;</font><font color="olive" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">(</font><font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">uint</font><font color="olive" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">)</font><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">sg</font><font color="olive" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">(</font><font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">request_info</font><font color="olive" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">)</font><font color="gray" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">.</font><font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">content_length</font><font color="gray" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp;-&nbsp;</font><font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">sg</font><font color="olive" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">(</font><font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">read_post_bytes</font><font color="olive" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">))</font><font color="gray" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">;<br style="word-wrap: break-word;" />\r\n &nbsp; &nbsp;&nbsp;</font><font color="green" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">while</font><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <font color="olive" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">(</font><font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">read_bytes</font><font color="gray" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp;&lt;&nbsp;</font><font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">count_bytes</font><font color="olive" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">)</font><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <font color="olive" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">{</font><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <font color="#ffa500" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">#if php_fastcgi</font><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <font color="green" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">if</font><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <font color="olive" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">(</font><font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">fcgi_is_fastcgi</font><font color="olive" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">())</font><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <font color="olive" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">{</font><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">fcgi_request</font><font color="gray" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp;*</font><font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">request</font><font color="gray" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp;=&nbsp;</font><font color="olive" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">(</font><font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">fcgi_request</font><font color="gray" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">*</font><font color="olive" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">)</font><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">sg</font><font color="olive" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">(</font><font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">server_context</font><font color="olive" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">)</font><font color="gray" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">;<br style="word-wrap: break-word;" />\r\n  &nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;</font><font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">tmp_read_bytes</font><font color="gray" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp;=&nbsp;</font><font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">fcgi_read</font><font color="olive" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">(</font><font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">request</font><font color="gray" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">,&nbsp;</font><font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">pos</font><font color="gray" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">,&nbsp;</font><font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">count_bytes</font><font color="gray" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp;-&nbsp;</font><font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">read_bytes</font><font color="olive" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">)</font><font color="gray" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">;<br style="word-wrap: break-word;" />\r\n &nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;</font><font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">pos</font><font color="gray" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp;+=&nbsp;</font><font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">tmp_read_bytes</font><font color="gray" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">;<br style="word-wrap: break-word;" />\r\n &nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;</font><font color="olive" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">}</font><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <font color="green" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">else</font><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <font color="olive" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">{</font><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">tmp_read_bytes</font><font color="gray" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp;=&nbsp;</font><font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">read</font><font color="olive" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">(</font><font color="maroon" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">0</font><font color="gray" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">,&nbsp;</font><font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">buffer</font><font color="gray" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp;+&nbsp;</font><font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">read_bytes</font><font color="gray" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">,&nbsp;</font><font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">count_bytes</font><font color="gray" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp;-&nbsp;</font><font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">read_bytes</font><font color="olive" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">)</font><font color="gray" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">;<br style="word-wrap: break-word;" />\r\n &nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;</font><font color="olive" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">}</font><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <font color="#ffa500" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">#else</font><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">tmp_read_bytes</font><font color="gray" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp;=&nbsp;</font><font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">read</font><font color="olive" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">(</font><font color="maroon" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">0</font><font color="gray" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">,&nbsp;</font><font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">buffer</font><font color="gray" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp;+&nbsp;</font><font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">read_bytes</font><font color="gray" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">,&nbsp;</font><font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">count_bytes</font><font color="gray" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp;-&nbsp;</font><font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">read_bytes</font><font color="olive" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">)</font><font color="gray" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">;</font><br style="word-wrap: break-word;" />\r\n  <font color="#ffa500" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">#endif</font><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <font color="green" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">if</font><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <font color="olive" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">(</font><font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">tmp_read_bytes</font><font color="gray" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp;&lt;=&nbsp;</font><font color="maroon" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">0</font><font color="olive" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">)</font><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <font color="olive" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">{</font><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <font color="green" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">break</font><font color="gray" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">;<br style="word-wrap: break-word;" />\r\n &nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;</font><font color="olive" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">}</font><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">read_bytes</font><font color="gray" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp;+=&nbsp;</font><font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">tmp_read_bytes</font><font color="gray" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">;<br style="word-wrap: break-word;" />\r\n &nbsp; &nbsp;&nbsp;</font><font color="olive" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">}</font><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <font color="green" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">return</font><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">read_bytes</font><font color="gray" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">;</font><br style="word-wrap: break-word;" />\r\n  <font color="olive" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">}</font><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">14. sapi_cgi_read_cookies, 这个和上面的函数一样，只不过是去获取cookie值：</span><font color="green" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">static</font><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">char</font><font color="gray" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp;*</font><font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">sapi_cgi_read_cookies</font><font color="olive" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">(</font><font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">tsrmls_d</font><font color="olive" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">)</font><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <font color="olive" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">{</font><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <font color="green" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">return</font><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">sapi_cgibin_getenv</font><font color="olive" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">((</font><font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">char</font><font color="gray" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp;*</font><font color="olive" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">)</font><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <font color="#8b0000" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&quot;</font><font color="red" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">http_cookie</font><font color="#8b0000" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&quot;</font><font color="gray" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">,&nbsp;</font><font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">sizeof</font><font color="olive" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">(</font><font color="#8b0000" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&quot;</font><font color="red" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">http_cookie</font><font color="#8b0000" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&quot;</font><font color="olive" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">)</font><font color="gray" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">-</font><font color="maroon" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">1</font><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">tsrmls_cc</font><font color="olive" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">)</font><font color="gray" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">;</font><br style="word-wrap: break-word;" />\r\n  <font color="olive" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">}</font><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">15. sapi_cgi_register_variables,这个函数给了一个接口，用以给$_server变量中添加变量，对于cgi来说，注册了一个php_self,这样我们就可以在脚本中访问$_server[&#39;php_self&#39;]来获取本次的request_uri：</span><font color="green" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">static</font><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">void</font><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">sapi_cgi_register_variables</font><font color="olive" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">(</font><font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">zval</font><font color="gray" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp;*</font><font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">track_vars_array</font><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">tsrmls_dc</font><font color="olive" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">)</font><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <font color="olive" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">{</font><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <font color="#ffa500" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">/* in cgi mode, we consider the environment to be a part of the server<br style="word-wrap: break-word;" />\r\n  &nbsp; &nbsp;&nbsp;&nbsp;* variables<br style="word-wrap: break-word;" />\r\n &nbsp; &nbsp;&nbsp;&nbsp;*/</font><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">php_import_environment_variables</font><font color="olive" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">(</font><font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">track_vars_array</font><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">tsrmls_cc</font><font color="olive" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">)</font><font color="gray" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">;<br style="word-wrap: break-word;" />\r\n &nbsp; &nbsp;&nbsp;</font><font color="#ffa500" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">/* build the special-case php_self variable for the cgi version */</font><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">php_register_variable</font><font color="olive" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">(</font><font color="#8b0000" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&quot;</font><font color="red" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">php_self</font><font color="#8b0000" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&quot;</font><font color="gray" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">,&nbsp;</font><font color="olive" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">(</font><font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">sg</font><font color="olive" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">(</font><font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">request_info</font><font color="olive" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">)</font><font color="gray" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">.</font><font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">request_uri</font><font color="gray" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp;?&nbsp;</font><font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">sg</font><font color="olive" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">(</font><font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">request_info</font><font color="olive" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">)</font><font color="gray" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">.</font><font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">request_uri</font><font color="gray" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp;:&nbsp;</font><font color="#8b0000" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&quot;&quot;</font><font color="olive" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">)</font><font color="gray" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">,&nbsp;</font><font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">track_vars_array</font><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">tsrmls_cc</font><font color="olive" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">)</font><font color="gray" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">;</font><br style="word-wrap: break-word;" />\r\n  <font color="olive" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">}</font><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">16. sapi_cgi_log_message ，用来输出错误信息，对于cgi来说，只是简单的输出到stderr:</span><font color="green" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">static</font><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">void</font><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">sapi_cgi_log_message</font><font color="olive" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">(</font><font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">char</font><font color="gray" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp;*</font><font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">message</font><font color="olive" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">)</font><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <font color="olive" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">{</font><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <font color="#ffa500" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">#if php_fastcgi</font><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <font color="green" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">if</font><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <font color="olive" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">(</font><font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">fcgi_is_fastcgi</font><font color="olive" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">()</font><font color="gray" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp;&amp;&amp;&nbsp;</font><font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">fcgi_logging</font><font color="olive" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">)</font><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <font color="olive" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">{</font><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">fcgi_request</font><font color="gray" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp;*</font><font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">request</font><font color="gray" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">;<br style="word-wrap: break-word;" />\r\n &nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;</font><font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">tsrmls_fetch</font><font color="olive" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">()</font><font color="gray" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">;<br style="word-wrap: break-word;" />\r\n  <br style="word-wrap: break-word;" />\r\n &nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;</font><font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">request</font><font color="gray" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp;=&nbsp;</font><font color="olive" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">(</font><font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">fcgi_request</font><font color="gray" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">*</font><font color="olive" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">)</font><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">sg</font><font color="olive" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">(</font><font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">server_context</font><font color="olive" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">)</font><font color="gray" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">;<br style="word-wrap: break-word;" />\r\n  &nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;</font><font color="green" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">if</font><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <font color="olive" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">(</font><font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">request</font><font color="olive" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">)</font><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <font color="olive" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">{</font><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">int</font><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">len</font><font color="gray" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp;=&nbsp;</font><font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">strlen</font><font color="olive" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">(</font><font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">message</font><font color="olive" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">)</font><font color="gray" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">;<br style="word-wrap: break-word;" />\r\n &nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;</font><font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">char</font><font color="gray" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp;*</font><font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">buf</font><font color="gray" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp;=&nbsp;</font><font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">malloc</font><font color="olive" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">(</font><font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">len</font><font color="gray" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">+</font><font color="maroon" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">2</font><font color="olive" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">)</font><font color="gray" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">;<br style="word-wrap: break-word;" />\r\n <br style="word-wrap: break-word;" />\r\n &nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;</font><font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">memcpy</font><font color="olive" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">(</font><font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">buf</font><font color="gray" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">,&nbsp;</font><font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">message</font><font color="gray" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">,&nbsp;</font><font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">len</font><font color="olive" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">)</font><font color="gray" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">;<br style="word-wrap: break-word;" />\r\n  &nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;</font><font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">memcpy</font><font color="olive" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">(</font><font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">buf</font><font color="gray" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp;+&nbsp;</font><font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">len</font><font color="gray" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">,&nbsp;</font><font color="#8b0000" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&quot;</font><font color="navy" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">\\n</font><font color="#8b0000" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&quot;</font><font color="gray" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">,&nbsp;</font><font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">sizeof</font><font color="olive" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">(</font><font color="#8b0000" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&quot;</font><font color="navy" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">\\n</font><font color="#8b0000" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&quot;</font><font color="olive" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">))</font><font color="gray" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">;<br style="word-wrap: break-word;" />\r\n &nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;</font><font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">fcgi_write</font><font color="olive" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">(</font><font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">request</font><font color="gray" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">,&nbsp;</font><font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">fcgi_stderr</font><font color="gray" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">,&nbsp;</font><font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">buf</font><font color="gray" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">,&nbsp;</font><font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">len</font><font color="gray" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">+</font><font color="maroon" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">1</font><font color="olive" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">)</font><font color="gray" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">;<br style="word-wrap: break-word;" />\r\n  &nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;</font><font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">free</font><font color="olive" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">(</font><font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">buf</font><font color="olive" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">)</font><font color="gray" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">;<br style="word-wrap: break-word;" />\r\n  &nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;</font><font color="olive" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">}</font><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <font color="green" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">else</font><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <font color="olive" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">{</font><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">fprintf</font><font color="olive" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">(</font><font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">stderr</font><font color="gray" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">,&nbsp;</font><font color="#8b0000" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&quot;</font><font color="red" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">%s</font><font color="navy" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">\\n</font><font color="#8b0000" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&quot;</font><font color="gray" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">,&nbsp;</font><font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">message</font><font color="olive" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">)</font><font color="gray" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">;<br style="word-wrap: break-word;" />\r\n &nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;</font><font color="olive" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">}</font><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <font color="#ffa500" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">/* ignore return code */</font><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <font color="olive" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">}</font><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <font color="green" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">else</font><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <font color="#ffa500" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">#endif /* php_fastcgi */</font><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">fprintf</font><font color="olive" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">(</font><font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">stderr</font><font color="gray" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">,&nbsp;</font><font color="#8b0000" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&quot;</font><font color="red" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">%s</font><font color="navy" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">\\n</font><font color="#8b0000" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&quot;</font><font color="gray" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">,&nbsp;</font><font color="blue" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">message</font><font color="olive" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">)</font><font color="gray" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">;</font><br style="word-wrap: break-word;" />\r\n  <font color="olive" style="word-wrap: break-word; font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">}</font><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">经过分析，我们已经了解了一个sapi是如何实现的了， 分析过cgi以后，我们也就可以想象mod_php, embed等sapi的实现机制。 ：）</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">今天就到这里， 西班牙和中国加时了，呵呵，中国男篮还不错。。。。。。</span></p>', NULL, 1444301028, -1062731039, 5, 1, 3, 0, 1, 0, 0, NULL, 0, NULL, 0);
INSERT INTO `details` (`id`, `first`, `tid`, `authorid`, `title`, `content`, `smiley`, `addtime`, `addip`, `classid`, `replycount`, `hits`, `istop`, `elite`, `ishot`, `rate`, `attachment`, `isdel`, `style`, `isdisplay`) VALUES
(6, 1, 0, 1, '【架构与优化】从facebook中集思广益，相互学习', '<p style="word-wrap: break-word; margin: 0px; padding: 0px; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 30px; text-indent: 2em;">\r\n 本人才学疏浅，提出这个问题只是为了抛砖引玉，希望大家能在自己擅长的领域里对facebook中可能采用的某个技术或者架构方案或优化方法，做个自己的论述。根据2008年9月1日，腾讯网对facebook的技术运营副总裁<font face="宋体" style="word-wrap: break-word;"><font style="word-wrap: break-word; font-size: 12px;">jonathan heiliger的访问，我们了解到：</font></font><br style="word-wrap: break-word;" />\r\n  <font face="宋体" style="word-wrap: break-word;"><font size="3" style="word-wrap: break-word;"><font color="#000000" style="word-wrap: break-word;"><font style="word-wrap: break-word; font-size: 12px;">（1）facebook自称全球流量第四的网站，每天9000万活跃用户访问facebook的1万台服务器。</font></font></font></font><br style="word-wrap: break-word;" />\r\n <font face="宋体" style="word-wrap: break-word;"><font size="3" style="word-wrap: break-word;"><font color="#000000" style="word-wrap: break-word;"><font style="word-wrap: break-word; font-size: 12px;">（2）25tb数据（08年12月为28tb），40万名外部开发者支持，开发了2.5万套应用软件。</font></font></font></font><br style="word-wrap: break-word;" />\r\n <font face="宋体" style="word-wrap: break-word;"><font size="3" style="word-wrap: break-word;"><font color="#000000" style="word-wrap: break-word;"><font style="word-wrap: break-word; font-size: 12px;">（3）<font color="#4e2727" style="word-wrap: break-word;"><font face="arial" style="word-wrap: break-word;">使用lamp（<font color="#ff0000" style="word-wrap: break-word;"><font color="#9900ff" style="word-wrap: break-word;">linux</font>、&nbsp;<font color="#0000ff" style="word-wrap: break-word;">apache</font>、<font color="#ff0000" style="word-wrap: break-word;">&nbsp;mysql</font>、&nbsp;</font><font color="#ff00ff" style="word-wrap: break-word;">php</font>）技术构架；数据库使用mysql；使用memcached缓存sql加速（全球最大的分布式memcached缓存，800多台服务器，光缓存在memcached中数据就达20多tb）；使用apc进行opcode编译缓存。关于php的编译执行如下图所示：</font></font></font></font></font></font></p>\r\n<p style="word-wrap: break-word; margin: 0px; padding: 0px; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 30px; text-indent: 2em;">\r\n  而facebook的缓存方案如下图所示：<br style="word-wrap: break-word;" />\r\n <br style="word-wrap: break-word;" />\r\n <font face="arial" style="word-wrap: break-word;"><font size="3" style="word-wrap: break-word;"><font color="#4e2727" style="word-wrap: break-word;"><font style="word-wrap: break-word; font-size: 12px;">（4）<span style="word-wrap: break-word; font-weight: 700;"><font face="arial" style="word-wrap: break-word;"><font style="word-wrap: break-word;"><span style="word-wrap: break-word;">一些后台应用是用python、<font color="#000000" style="word-wrap: break-word;">perl和java，以及一些gcc和boost。</font></span></font></font></span></font></font></font></font></p>\r\n<p>\r\n <font face="arial" style="word-wrap: break-word; color: rgb(68, 68, 68); font-size: 14px; line-height: 21px;"><font size="3" style="word-wrap: break-word;"><font style="word-wrap: break-word; font-size: 12px;"><font color="#000000" style="word-wrap: break-word;">（5）使用svn和git来进行代码管理，并且全部企业内部的软件部署都采用开源程序。</font></font></font></font><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <br style="word-wrap: break-word;" />\r\n &nbsp;</p>\r\n<p style="word-wrap: break-word; margin: 0px; padding: 0px; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 30px; text-indent: 2em;">\r\n <font face="verdana, helvetica, arial, sans-serif" style="word-wrap: break-word;"><font face="arial" style="word-wrap: break-word;"><font size="3" style="word-wrap: break-word;"><font style="word-wrap: break-word; font-size: 12px;"><span style="word-wrap: break-word; font-weight: 700;"><font face="verdana, helvetica, arial, sans-serif" style="word-wrap: break-word;"><font style="word-wrap: break-word; font-size: 14px;">2. 可能会采用的mysql架构与优化</font></font></span></font></font></font><br style="word-wrap: break-word;" />\r\n <span style="word-wrap: break-word; font-weight: 700;"><font face="宋体" style="word-wrap: break-word;"><font style="word-wrap: break-word; font-size: 12px;">（1）数据的垂直（无关联数据放置不同数据库服务器）与水平分割（库表散列，如用user_id散列），然后用mysql proxy/spock proxy进行分割表的反向代理。</font></font></span><br style="word-wrap: break-word;" />\r\n  <font face="宋体" style="word-wrap: break-word;"><font size="3" style="word-wrap: break-word;"><font style="word-wrap: break-word; font-size: 12px;">（2）合理使用变量，并在本地文件建立散列的映射关系，进一步进行分割。</font></font></font><br style="word-wrap: break-word;" />\r\n <font face="宋体" style="word-wrap: break-word;"><font size="3" style="word-wrap: break-word;"><font style="word-wrap: break-word; font-size: 12px;">（3）master/slave集群架构，实现读写分离。</font></font></font><br style="word-wrap: break-word;" />\r\n  <font face="宋体" style="word-wrap: break-word;"><font size="3" style="word-wrap: break-word;"><font style="word-wrap: break-word; font-size: 12px;">（4）合理的数据库结构设计，与索引优化</font></font></font></font></p>\r\n<p style="word-wrap: break-word; margin: 0px; padding: 0px; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 30px; text-indent: 2em;">\r\n <font face="宋体" style="word-wrap: break-word;"><font size="2" style="word-wrap: break-word;">（5）其他：索引缓存、联合索引、查询缓存等。</font></font></p>\r\n<p style="word-wrap: break-word; margin: 0px; padding: 0px; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 30px; text-indent: 2em;">\r\n  &nbsp;</p>\r\n<p>\r\n <br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="word-wrap: break-word; font-weight: 700; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;"><font color="#000000" style="word-wrap: break-word;">3. 可能会采用的系统优化</font></span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <font face="宋体" style="word-wrap: break-word; color: rgb(68, 68, 68); font-size: 14px; line-height: 21px;"><font size="2" style="word-wrap: break-word;"><span style="word-wrap: break-word; font-weight: 700;">（1）使用epoll模型</span></font></font><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <span style="word-wrap: break-word; font-weight: 700; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;"><font face="宋体" style="word-wrap: break-word;"><font size="2" style="word-wrap: break-word;">（2）异步i/o</font></font></span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <span style="word-wrap: break-word; font-weight: 700; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;"><font face="宋体" style="word-wrap: break-word;"><font size="2" style="word-wrap: break-word;">（3）fastcgi或其他方法实现多进程</font></font></span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <span style="word-wrap: break-word; font-weight: 700; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;"><font face="宋体" style="word-wrap: break-word;"><font size="2" style="word-wrap: break-word;">（4）sendfile系统调用增大网络i/o流量</font></font></span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <font face="arial" style="word-wrap: break-word; color: rgb(68, 68, 68); font-size: 14px; line-height: 21px;"><font color="#000000" style="word-wrap: break-word;"><font size="3" style="word-wrap: break-word;"><span style="word-wrap: break-word; font-weight: 700;"><font face="verdana" style="word-wrap: break-word;">4. 可能会采用的web架构或前端技术</font></span></font></font></font><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <font face="arial" style="word-wrap: break-word; color: rgb(68, 68, 68); font-size: 14px; line-height: 21px;"><font color="#000000" style="word-wrap: break-word;"><font size="3" style="word-wrap: break-word;"><span style="word-wrap: break-word; font-weight: 700;"><font face="宋体" style="word-wrap: break-word;"><font size="2" style="word-wrap: break-word;"><font color="#444444" style="word-wrap: break-word;">（1）web组件分离，如独立的图片服务器，javascript、css文件、动态脚本的分离。</font></font></font></span></font></font></font><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <font face="arial" style="word-wrap: break-word; color: rgb(68, 68, 68); font-size: 14px; line-height: 21px;"><font color="#000000" style="word-wrap: break-word;"><font size="3" style="word-wrap: break-word;"><span style="word-wrap: break-word; font-weight: 700;"><font face="宋体" style="word-wrap: break-word;"><font size="2" style="word-wrap: break-word;"><font color="#444444" style="word-wrap: break-word;">（2）nginx反向代理（或squid）</font></font></font></span></font></font></font><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <span style="word-wrap: break-word; font-weight: 700; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;"><font face="宋体" style="word-wrap: break-word;"><font size="2" style="word-wrap: break-word;">（3）多副本负载均衡</font></font></span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <span style="word-wrap: break-word; font-weight: 700; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;"><font face="宋体" style="word-wrap: break-word;"><font size="2" style="word-wrap: break-word;">（4）http持久连接与合理利用浏览器缓存，例如背景图偏移量技术，及对css、javascript和视频的</font></font></span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="word-wrap: break-word; font-weight: 700; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;"><font size="3" style="word-wrap: break-word;"><font color="#000000" style="word-wrap: break-word;">5. 一些可能会用也可能不用的压力测试</font></font></span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="word-wrap: break-word; font-weight: 700; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;"><font size="3" style="word-wrap: break-word;"><font color="#000000" style="word-wrap: break-word;"><span style="word-wrap: break-word;"><font face="宋体" style="word-wrap: break-word;"><font size="2" style="word-wrap: break-word;"><font color="#444444" style="word-wrap: break-word;">（1）apache的ab进行压力测试</font></font></font></span></font></font></span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="word-wrap: break-word; font-weight: 700; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;"><font face="宋体" style="word-wrap: break-word;"><font size="2" style="word-wrap: break-word;">（2）apache的prefork模式进行多进程切换的压力测试</font></font></span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="word-wrap: break-word; font-weight: 700; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;"><font face="宋体" style="word-wrap: break-word;"><font size="2" style="word-wrap: break-word;">（3）使用nginx为多进程下的cpu与io进行监控</font></font></span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <font face="arial" style="word-wrap: break-word; color: rgb(68, 68, 68); font-size: 14px; line-height: 21px;"><font size="3" style="word-wrap: break-word;"><font color="#000000" style="word-wrap: break-word;">linux下的memcached开发，请参看逆雪寒的文章</font></font></font><font face="arial" style="word-wrap: break-word; color: rgb(68, 68, 68); font-size: 14px; line-height: 21px;"><font size="3" style="word-wrap: break-word;"><font color="#000000" style="word-wrap: break-word;"><a href="http://bbs.phpchina.com/viewthread.php?tid=48667&amp;highlight=linux%2b%cf%c2%b5%c4%2bmemcached%2b%bf%aa%b7%a2" style="word-wrap: break-word; color: rgb(30, 84, 127);" target="_blank">http://bbs.phpchina.com/viewthread.php?tid=48667&amp;highlight=linux%2b%cf%c2%b5%c4%2bmemcached%2b%bf%aa%b7%a2</a></font></font></font><br style="word-wrap: break-word;" />\r\n  <font face="arial" style="word-wrap: break-word; color: rgb(68, 68, 68); font-size: 14px; line-height: 21px;"><font size="3" style="word-wrap: break-word;"><font color="#000000" style="word-wrap: break-word;"><font style="word-wrap: break-word; font-size: 12px;">memcached的分布式缓存机制及相关解决方案请阅读以下网址及相关文章：</font></font></font></font><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <font face="arial" style="word-wrap: break-word; color: rgb(68, 68, 68); font-size: 14px; line-height: 21px;"><font size="3" style="word-wrap: break-word;"><font color="#000000" style="word-wrap: break-word;"><font style="word-wrap: break-word; font-size: 12px;"><a href="http://tech.idv2.com/2008/07/24/memcached-004/" style="word-wrap: break-word; color: rgb(30, 84, 127);" target="_blank">http://tech.idv2.com/2008/07/24/memcached-004/</a></font></font></font></font></p>', NULL, 1444301117, -1062731039, 5, 10, 21, 0, 1, 1, 0, NULL, 0, NULL, 0);
INSERT INTO `details` (`id`, `first`, `tid`, `authorid`, `title`, `content`, `smiley`, `addtime`, `addip`, `classid`, `replycount`, `hits`, `istop`, `elite`, `ishot`, `rate`, `attachment`, `isdel`, `style`, `isdisplay`) VALUES
(7, 1, 0, 1, '树操作算法，非递归方法', '<p>\r\n  <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">前些日子和一些朋友讨论关于无限分类的算法问题，其中提到了利用php数组进行操作的想法。其实无限分类算法就是树的算法。</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">利用数据库存储数据加递归搜索似乎是目前很流行的一种方法，但这种方法的效率低下，并增加了不少数据库的负担。</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">我这个算法采用文本方式存储数据，效率应该还可以。由于时间关系，算法是匆匆完成没有经过严格测试就放上来了，大家有兴趣的话就测试一下，找找其中的bug，或改善一下算法的性能。</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">提醒一点，如果你的php可利用的内存不到1g，请不要尝试去创建一个具有100万个节点的树。。。:lol:</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">树的操作算法是各种高级数据结构算法的基础，估计不少同学在大学的时候都学烂了，所以我就不必细讲了。现在要讨论的是如何在php这个编程环境里面如果实现该算法最大的性能。</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">好吧，我来抛砖引玉。</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">因时间关系没有写注释，看不懂的同学可以提问。</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">[php]</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&lt;?php</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">/**</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">* 树操作类</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">*</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">* 利用php数组对树进行构造，删除和遍历等操作，全部遍历采用非递归方法实现，并实现iterator和countable操作。</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">* 该算法可适用与无限分类等相关领域，对于同时操作百万级以上的数据可能需要512m以上的内存支持。</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">* 利用文本存储数据结构，如果需要数据库存储可继承本类并覆盖loadtree和savetree方法。</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">*</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">* @copyrihgt&nbsp;</span><a href="mailto:sentrychen@hotmail.com" style="word-wrap: break-word; color: rgb(30, 84, 127); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">sentrychen@hotmail.com</a><span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">, 2008</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">* @author sentrychen&nbsp;</span><a href="mailto:sentrychen@hotmail.com" style="word-wrap: break-word; color: rgb(30, 84, 127); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">sentrychen@hotmail.com</a><span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&gt;</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">* @version $id: tree.php, v 0.0.1 2008/10/01 11:51:25 uw exp $</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">*/</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">class itc_tree implements iterator,countable</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">{</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp; const id = &#39;i&#39;;</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp; const pid = &#39;p&#39;;</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp; const level =&#39;l&#39;;</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp; const data = &#39;d&#39;;</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp; const children = &#39;c&#39;;</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp; const dfs = &#39;dfs&#39;;</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp; const bfs = &#39;bfs&#39;;</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp; protected $_tree = array();</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp; protected $_filename = &#39;&#39;;</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp; protected $_prefix = &#39;tree_&#39;;</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp; protected $_path = &#39;&#39;;</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp; protected $_rootid = 0;</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp; protected $_lastid = 0;</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp; protected $_way = self::dfs;</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp; protected $_stack = array();</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp;</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp; public function __construct($name, $path = &#39;&#39;)</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp; {</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;$this-&gt;loadtree($name, $path);</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp; }</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp; public function loadtree ($name, $path = &#39;&#39;)</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp; {</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;if ($path != &#39;&#39;) {</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;if (is_dir($path)) {</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp; $this-&gt;_path = rtrim($path, &#39;/\\\\&#39;) . directory_separator;</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;} else {</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp; die(&#39;no such directory :&#39; . $path);</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;}</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;}</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;$name = md5($name);</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;$this-&gt;_filename = $this-&gt;_path . $this-&gt;_prefix . $name ;</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;if (is_file($this-&gt;_filename)) {</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;_tree = json_decode(file_get_contents($this-&gt;_filename),true);</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;_inittree();</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;return true;</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;}</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;return false;</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp; }</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp; protected function _inittree ()</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp; {</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;$ary = $this-&gt;listtotree($this-&gt;_tree);</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;$this-&gt;_rootid = $ary[&#39;topid&#39;];</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;$this-&gt;_lastid = $ary[&#39;lastid&#39;];</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;$this-&gt;_tree[$this-&gt;_rootid][self::level] = 1;</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;return $this;</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp; }</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp;</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp; public function listtotree(&amp;$list){</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;$return = array(&#39;topid&#39;=&gt;0,&#39;lastid&#39;=&gt;0);</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;foreach ($list as $id =&gt; &amp;$node){</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp; if (isset($list[$node[self::pid]]))</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;$list[$node[self::pid]][self::children][$id] = &amp;$node;</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp; else</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;$return[&#39;topid&#39;] = $id;</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp; if ($id &gt; $return[&#39;lastid&#39;]) $return[&#39;lastid&#39;] = $id;</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;}</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;return $return;</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp; }</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp;</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp; public function settreebylist (array $list)</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp; {</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;if (!$this-&gt;_checklist($list)){</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;die(&#39;incorrect data format&#39;);</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;}</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;$this-&gt;_tree = $list;</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;$this-&gt;_inittree();</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;return true;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp; }</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp;</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp; public function gettree($id = null)</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp; {</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;if (null === $id) $id = $this-&gt;_rootid;</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;if (isset($this-&gt;_tree[$id]))</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;return $this-&gt;_tree[$id];</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;else</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;return null;</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp; }</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp;</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp; public function getparent($id){</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;if (isset($this-&gt;_tree[$id]) &amp;&amp; isset($this-&gt;_tree[$this-&gt;_tree[$id][self::parent]])){</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;return $this-&gt;_tree[$this-&gt;_tree[$id][self::parent]];</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;}</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;return null;</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp; }</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp; public function getparentsid($start,$level = null)</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp; {&nbsp; &nbsp;</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;$parent = array();</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;$id = $start;</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;do{</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;if (!isset($this-&gt;_tree[$id])) break;</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;$pid = $this-&gt;_tree[$id][self::pid];</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;if (null !== $level &amp;&amp; !$level--) break;</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;if (!isset($this-&gt;_tree[$pid])) break;</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;}</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;while(true);</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;return $parent;</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp; }</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp;</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp; public function getchildren($id){</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;if (isset($this-&gt;_tree[$id])){</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;return $this-&gt;_tree[$id][self::children];</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;}</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;return null;</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp; }</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp;</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp; public function gettreeall()</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp; {</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;return $this-&gt;_tree;</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp; }</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp;</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp; public function gettreelist()</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp; {</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;if (isset($this-&gt;_tree)) {</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;return $this-&gt;tolist($this-&gt;_tree);</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;}</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;return null;</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp; }</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp;</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp; public function tolist($tree){</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;$ary = array();</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;foreach ($tree as $id =&gt; $node){</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;unset($node[self::children]);</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;$ary[$id] = $node;</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;}</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;return $ary;</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp; }</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp;</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp; public function getdepth(){</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;$depth = 1;</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;$id = $this-&gt;_rootid;</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;$stack = array($id);</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;$i = 0;</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;if (!isset($this-&gt;_tree[$id][self::level]))</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;_tree[$id][self::level] = 1;</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;do{</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;$id = $stack[$i++];</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;$pid = $this-&gt;_tree[$id][self::pid];</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;if (isset($this-&gt;_tree[$id][self::children])){</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;$stack = array_merge($stack,array_keys($this-&gt;_tree[$id][self::children]));&nbsp; &nbsp;</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;}</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;if (isset($this-&gt;_tree[$id][self::level])){</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp; $level = $this-&gt;_tree[$id][self::level];</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;}</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;else {</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp; $level = $this-&gt;_tree[$pid][self::level] + 1;</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp; $this-&gt;_tree[$id][self::level] = $level;</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;}</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;if ($depth &lt; $level) $depth = $level;</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;}while(isset($stack[$i]));</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;return $depth;</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp; }</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp;</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp; public function getlastid(){</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;return $this-&gt;_lastid;</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp; }</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp;</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp; public function getrootid(){</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;return $this-&gt;_rootid;</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp; }</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp;</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp; public function getroot(){</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;return $this-&gt;_tree[$this-&gt;_rootid];</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp; }</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp; public function getdata($id){</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;if (isset($this-&gt;_tree[$id])){</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;return $this-&gt;_tree[$id][self::data];</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;}</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;return null;</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp; }</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp;</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp; public function setdata($id,$data){</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;if (isset($this-&gt;_tree[$id])){</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;_tree[$id][self::data] = $data;</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;return true;</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;}</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;return false;</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp; }</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp; public function addroot($data = null)</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp; {</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;$root = array(</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;self::id =&gt; $this-&gt;_rootid,&nbsp;</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;self::pid =&gt; $this-&gt;_rootid - 1,&nbsp;</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;self::level =&gt; 1,</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;self::data =&gt; $data</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;);&nbsp;&nbsp;</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;$this-&gt;_tree[$this-&gt;_rootid] = &amp;$root;</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;$this-&gt;_lastid = $this-&gt;_rootid;</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;return $this-&gt;_rootid;</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp; }</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp; public function addleaf($pid,$data = null)</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp; {</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;if (!isset($this-&gt;_tree[$pid])){</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;if (isset($this-&gt;_tree[$this-&gt;_rootid]))</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp; $pid = $this-&gt;_rootid;</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;else {</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp; $this-&gt;_lastid = $this-&gt;addroot($data);&nbsp;</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp; return $this-&gt;_lastid;</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;}</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;}</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;$id = ++$this-&gt;_lastid;</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;$level = isset($this-&gt;_tree[$pid][self::level])? $this-&gt;_tree[$pid][self::level] + 1 : null;</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;$this-&gt;_tree[$id] = array(</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;self::id =&gt; $id,&nbsp;</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;self::pid =&gt; $pid,&nbsp;</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;self::level =&gt; $level,</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;self::data =&gt; $data</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;);</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;$this-&gt;_tree[$pid][self::children][$id] = &amp;$this-&gt;_tree[$id];</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;return $id;</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp; }</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp; public function insertchild($pid, $children)</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp; {</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;if (!isset($this-&gt;_tree[$pid])){</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;return false;</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;}</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;if ($children instanceof self){</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;$children = $children-&gt;gettree();</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;}</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;if (is_array($children)){</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp; $children = $this-&gt;tolist($children);</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;$lastid = $this-&gt;_lastid + 1;</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;$list = array();</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;foreach ($children as $id =&gt; $node){</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp; $node[self::id] +=$lastid;</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp; $node[self::pid] +=$lastid;</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp; $list[$id + $lastid] = $node;</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;}</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;$ary = $this-&gt;listtotree($list);</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;_lastid = $ary[&#39;lastid&#39;];</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;$list[$ary[&#39;topid&#39;]][self::pid] = $pid;</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;_tree += $list;</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;_tree[$pid][self::children][$ary[&#39;topid&#39;]] = &amp;$this-&gt;_tree[$ary[&#39;topid&#39;]];</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;return $this-&gt;_lastid;</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;}</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;return $this-&gt;addleaf($pid,$children);</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp; }</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp;</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp; public function deletechild($id){</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;if (!isset($this-&gt;_tree[$id])){</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;return null;</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;}</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;$pid = $this-&gt;_tree[$id][self::pid];</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;$deltree = array();</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;if (isset($this-&gt;_tree[$pid])){</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;unset($this-&gt;_tree[$pid][self::children][$id]);</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;}</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;$stack = array($id);</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;do{</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;$id = array_pop($stack);</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;if (isset($this-&gt;_tree[$id][self::children]))</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp; $stack =array_merge($stack, array_keys($this-&gt;_tree[$id][self::children]));</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;$deltree[$id] = $this-&gt;_tree[$id];</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;unset($this-&gt;_tree[$id]);</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;}while(!empty($stack));</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;return $deltree;</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp; }</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp;</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp; public function emptytree(){</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;$this-&gt;_tree = array();</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;$this-&gt;_rootid = 0;</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;$this-&gt;_lastid = 0;</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;return true;</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp; }</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp;</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp; public function destroytree(){</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;$this-&gt;emptytree();</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;if (is_file($this-&gt;_filename))</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;unlink($this-&gt;_filename);</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;return true;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp; }</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp;</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp; protected function _checklist (array $list)</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp; {</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;$ischecked = true;</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;$topnum = 0;</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;foreach ($list as $id =&gt; $node) {</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;if (! isset($node[self::id]) || ! isset($node[self::pid]) || $node[self::id] != $id) {</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp; $ischecked = false;</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp; break;</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;}else{</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp; if (!isset($list[$node[self::pid]])) $topnum++;</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp; if ($topnum &gt; 1){</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;$ischecked = false;</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;break;</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp; }</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;}</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;}</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;return $ischecked;</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp; }</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp;</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp; public function getlevel($id){</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;if (isset($this-&gt;_tree[$id]) &amp;&amp; isset($this-&gt;_tree[$id][self::level]) )</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;return $this-&gt;_tree[$id][self::level];</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;$level = 0;</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;$id2 = $id;</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;while(isset($this-&gt;_tree[$id2])){</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;if (isset($this-&gt;_tree[$id2][self::level])){</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp; $level += $this-&gt;_tree[$id2][self::level];</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp; break;</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;}</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;$level++;</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;$id2 = $this-&gt;_tree[$id2][self::pid];</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;}</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;if (isset($this-&gt;_tree[$id]))</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;_tree[$id][self::level] = $level;</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;return $level;</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp; }</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp; public function dfs($callback = null,$id = null){</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;if (null === $id) $id = $this-&gt;_rootid;</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;if (!isset($this-&gt;_tree[$id])){</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;return null;</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;}</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;if (null == $callback || !function_exists($callback)){</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;return null;</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;}</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;$stack = array($id);</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;$return = null;</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;do{</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;$id = array_shift($stack);</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;$children = null;</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;if (isset($this-&gt;_tree[$id][self::children])){</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;$children = array_keys($this-&gt;_tree[$id][self::children]);</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;$stack = array_merge($children,$stack);</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;}</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;$args = array(</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp; self::id =&gt; $id,</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp; self::pid =&gt; $this-&gt;_tree[$id][self::pid],</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp; self::data =&gt; &amp;$this-&gt;_tree[$id][self::data],</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp; self::level =&gt; $this-&gt;getlevel($id),</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp; self::children =&gt; $children</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;);</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;$back = call_user_func($callback,$args);</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;if (isset($back)){</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;if (is_string($back)) $return .= $back;</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;else if (is_array($back)) $return[] = $back;</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;else if (is_int($back)) $return += $back;</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;else if (is_bool($back) &amp;&amp; $back) $return = $this-&gt;_tree[$id];</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;}</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;}while(!empty($stack));</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;return $return;</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp; }</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp;</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp; public function bfs($callback = null,$id = null){</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;if (null === $id) $id = $this-&gt;_rootid;</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;if (!isset($this-&gt;_tree[$id])){</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;return array();</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;}</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;if (null == $callback || !function_exists($callback)){</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;$callback = null;</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;}</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;$stack = array($id);</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;$return = null;</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;do{</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;$id = array_shift($stack);</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;$children = null;</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;if (isset($this-&gt;_tree[$id][self::children])){</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp; $children = array_keys($this-&gt;_tree[$id][self::children]);</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp; $stack = array_merge($stack,$children);&nbsp; &nbsp;</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;}&nbsp; &nbsp;</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;$args = array(</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp; self::id =&gt; $id,</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp; self::pid =&gt; $this-&gt;_tree[$id][self::pid],</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp; self::data =&gt; &amp;$this-&gt;_tree[$id][self::data],</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp; self::level =&gt; $this-&gt;getlevel($id),</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp; self::children =&gt; $children</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;);</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;$return = call_user_func($callback,$args);</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;if (isset($back)){</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;if (is_string($back)) $return .= $back;</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;else if (is_array($back)) $return[] = $back;</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;else if (is_int($back)) $return += $back;</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;else if (is_bool($back) &amp;&amp; $back) $return = $this-&gt;_tree[$id];</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;}</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;}while(!empty($stack));</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;return $return;</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp; }</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp;</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp; public function savetree(){</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;file_put_contents($this-&gt;_filename, json_encode($this-&gt;tolist($this-&gt;_tree)));</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;return true;</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp; }&nbsp; &nbsp;&nbsp;</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp; public function setway($way = self::dfs){</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;if (in_array($way,array(self::dfs,self::bfs))){</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;_way = $way;</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;rewind();</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;}</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;return $this;</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp; }</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp;</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp; public function rewind()</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp; {</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;if (isset($this-&gt;_tree[$this-&gt;_rootid]))</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;{</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;_stack = array($this-&gt;_rootid);</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;}</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;else{</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;_stack = array();</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;}</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;return $this;</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp; }</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp;</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp; public function next()</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp; {</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;$id = array_shift($this-&gt;_stack);</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;if (isset($this-&gt;_tree[$id][self::children])){</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;$children = array_keys($this-&gt;_tree[$id][self::children]);</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;if ($this-&gt;_way == self::bfs)</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;_stack = array_merge($this-&gt;_stack,$children);</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;else</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;$this-&gt;_stack = array_merge($children,$this-&gt;_stack);</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;}</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp; }</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp;</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp; public function count()</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp; {</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;return count($this-&gt;_tree);</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp; }</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp;</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp; public function key()</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp; {</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;return current($this-&gt;_stack);</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp; }</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp;</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp; public function current()</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp; {</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;$id = current($this-&gt;_stack);</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;if (isset($this-&gt;_tree[$id])){</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;return $this-&gt;_tree[$id];</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;}</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;else</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;return null;</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp; }</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp;</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp; public function valid()</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp; {</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;return !empty($this-&gt;_stack);</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">&nbsp; &nbsp; }</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">}</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">[/php]</span></p>', NULL, 1444301167, -1062731039, 5, 1, 18, 0, 1, 0, 5, NULL, 0, NULL, 0);
INSERT INTO `details` (`id`, `first`, `tid`, `authorid`, `title`, `content`, `smiley`, `addtime`, `addip`, `classid`, `replycount`, `hits`, `istop`, `elite`, `ishot`, `rate`, `attachment`, `isdel`, `style`, `isdisplay`) VALUES
(8, 1, 0, 1, '关于php你可能不知道的－php的事件驱动化设计', '<p>\r\n	dsacx</p>\r\n', NULL, 1444301218, -1062731039, 5, 0, 18, 0, 1, 0, 10, NULL, 0, 'red', 0),
(20, 0, 3, 23, 'seaslog: 高效、便捷、稳定的php日志扩展', '<p>\r\n	sdad</p>\r\n', NULL, 1503973543, 2130706433, 4, 0, 0, 0, 0, 0, 0, NULL, 0, NULL, 0),
(21, 0, 3, 23, 'seaslog: 高效、便捷、稳定的php日志扩展', '<p>\r\n	sdad</p>\r\n', NULL, 1503973570, 2130706433, 4, 0, 0, 0, 0, 0, 0, NULL, 0, NULL, 0),
(22, 0, 3, 23, 'seaslog: 高效、便捷、稳定的php日志扩展', '<p>\r\n	dasd</p>\r\n', NULL, 1503973632, 2130706433, 4, 0, 0, 0, 0, 0, 0, NULL, 0, NULL, 0),
(23, 0, 8, 23, '关于php你可能不知道的－php的事件驱动化设计', '<p>\r\n	a</p>\r\n', NULL, 1503974425, 2130706433, 4, 0, 2, 0, 0, 0, 0, NULL, 0, NULL, 0),
(24, 0, 8, 23, '关于php你可能不知道的－php的事件驱动化设计', '<p>\r\n	aa</p>\r\n', NULL, 1503975125, 2130706433, 4, 0, 0, 0, 0, 0, 0, NULL, 0, NULL, 0),
(82, 0, 5, 1, '深入理解zend sapis(zend sapi internals)', '<p>\r\n	很棒的</p>\r\n', NULL, 1504085020, 2130706433, 5, 0, 0, 0, 0, 0, 0, NULL, 0, NULL, 0),
(41, 1, 0, 1, '我觉得这波nice', '<p>\r\n	hello 大家好</p>\r\n', NULL, 1503992007, 2130706433, 3, 0, 0, 0, 0, 0, 0, NULL, 1, NULL, 0),
(42, 1, 0, 1, '大', '<p>\r\n	大</p>\r\n', NULL, 1503992314, 2130706433, 3, 0, 0, 1, 0, 0, 0, NULL, 1, NULL, 0),
(43, 1, 0, 1, '搜索', '<p>\r\n	啊</p>\r\n', NULL, 1503992345, 2130706433, 3, 1, 9, 0, 0, 0, 0, NULL, 0, NULL, 0),
(44, 1, 0, 1, '啊啊', '<p>\r\n	啊啊</p>\r\n', NULL, 1503992372, 2130706433, 3, 0, 0, 0, 0, 0, 0, NULL, 1, NULL, 0),
(45, 0, 43, 23, '搜索', '<p>\r\n	啊啊</p>\r\n', NULL, 1503994205, 2130706433, 3, 0, 0, 0, 0, 0, 0, NULL, 0, NULL, 0),
(46, 0, 43, 23, '搜索', '<p>\r\n	啊啊</p>\r\n', NULL, 1503994448, 2130706433, 3, 0, 0, 0, 0, 0, 0, NULL, 0, NULL, 0),
(47, 0, 43, 23, '搜索', '<p>\r\n	啊啊啊</p>\r\n', NULL, 1503994465, 2130706433, 3, 0, 0, 0, 0, 0, 0, NULL, 0, NULL, 0),
(48, 0, 43, 23, '搜索', '<p>\r\n	啊啊啊</p>\r\n', NULL, 1503994506, 2130706433, 3, 0, 0, 0, 0, 0, 0, NULL, 0, NULL, 0),
(49, 0, 43, 23, '搜索', '<p>\r\n	啊啊啊</p>\r\n', NULL, 1503994537, 2130706433, 3, 0, 0, 0, 0, 0, 0, NULL, 0, NULL, 0),
(50, 0, 43, 23, '搜索', '<p>\r\n	啊啊啊</p>\r\n', NULL, 1503994592, 2130706433, 3, 0, 0, 0, 0, 0, 0, NULL, 0, NULL, 0),
(51, 1, 0, 23, '倒萨', '<p>\r\n	啊啊</p>\r\n', NULL, 1503994618, 2130706433, 3, 0, 0, 0, 0, 0, 0, NULL, 1, NULL, 0),
(52, 1, 0, 23, '啊啊', '<p>\r\n	啊啊</p>\r\n', NULL, 1503997167, 2130706433, 4, 1, 3, 0, 0, 0, 0, NULL, 0, NULL, 0),
(53, 1, 0, 1, '啊啊', '<p>\r\n	啊啊</p>\r\n', NULL, 1503999916, 2130706433, 3, 0, 0, 0, 0, 0, 0, NULL, 1, NULL, 0),
(54, 1, 0, 1, '阿阿1', '<p>\r\n	宣传宣传</p>\r\n', NULL, 1503999926, 2130706433, 3, 0, 0, 1, 0, 0, 0, NULL, 1, NULL, 0),
(55, 1, 0, 1, '2222222221', '<p>\r\n	阿萨斯是试试试试试试试试</p>\r\n', NULL, 1503999932, 2130706433, 3, 0, 0, 0, 1, 0, 0, NULL, 1, NULL, 0),
(56, 1, 0, 1, '吖吖', '<p>\r\n	啊啊啊啊啊啊啊啊啊啊啊啊啊</p>\r\n', NULL, 1503999942, 2130706433, 3, 0, 0, 1, 1, 0, 0, NULL, 1, NULL, 0),
(57, 1, 0, 1, '啊啊啊', '<p>\r\n	的撒旦</p>\r\n', NULL, 1504000571, 2130706433, 3, 0, 0, 1, 0, 0, 0, NULL, 1, NULL, 0),
(58, 1, 0, 1, '呈现出', '<p>\r\n	阿萨</p>\r\n', NULL, 1504000580, 2130706433, 3, 0, 0, 0, 0, 0, 0, NULL, 0, NULL, 0),
(59, 1, 0, 1, '啊', '<p>\r\n	可爱</p>\r\n', NULL, 1504000587, 2130706433, 3, 0, 0, 1, 0, 0, 0, NULL, 1, NULL, 0),
(60, 1, 0, 1, '不对', '<p>\r\n	此信息</p>\r\n', NULL, 1504000597, 2130706433, 3, 0, 0, 0, 0, 0, 0, NULL, 0, NULL, 0),
(61, 1, 0, 1, '可以啊', '<p>\r\n	啊啊</p>\r\n', NULL, 1504000764, 2130706433, 3, 4, 38, 0, 0, 1, 0, NULL, 0, NULL, 0),
(62, 1, 0, 1, '倒萨', '<p>\r\n	倒萨</p>\r\n', NULL, 1504003857, 2130706433, 3, 0, 0, 0, 0, 0, 0, NULL, 1, NULL, 0),
(63, 1, 0, 1, '啊啊', '<p>\r\n	啊啊</p>\r\n', NULL, 1504003876, 2130706433, 3, 0, 0, 0, 0, 0, 0, NULL, 1, NULL, 0),
(64, 1, 0, 1, '总有可以的', '<p>\r\n	我是一个大朋友</p>\r\n', NULL, 1504003932, 2130706433, 3, 0, 2, 0, 1, 0, 0, NULL, 0, NULL, 0),
(65, 1, 0, 1, '2222222221', '<p>\r\n	22</p>\r\n', NULL, 1504063765, 2130706433, 3, 1, 17, 0, 1, 0, 0, NULL, 1, NULL, 0),
(66, 1, 0, 1, '打死', '<p>\r\n	大</p>\r\n', NULL, 1504064785, 2130706433, 3, 3, 13, 1, 1, 1, 5, NULL, 1, NULL, 0),
(67, 1, 0, 1, '大', '<p>\r\n	倒萨</p>\r\n', NULL, 1504064971, 2130706433, 3, 2, 8, 1, 0, 0, 0, NULL, 1, NULL, 0),
(68, 0, 67, 1, '大', '<p>\r\n	sds</p>\r\n', NULL, 1504076019, 2130706433, 3, 0, 0, 0, 0, 0, 0, NULL, 0, NULL, 0),
(69, 0, 67, 1, '大', '<p>\r\n	dsad</p>\r\n', NULL, 1504076022, 2130706433, 3, 0, 0, 0, 0, 0, 0, NULL, 0, NULL, 0),
(70, 0, 67, 1, '大', '<p>\r\n	dsada</p>\r\n', NULL, 1504076028, 2130706433, 3, 0, 0, 0, 0, 0, 0, NULL, 0, NULL, 0),
(71, 0, 67, 1, '大', '<p>\r\n	da</p>\r\n', NULL, 1504076034, 2130706433, 3, 0, 0, 0, 0, 0, 0, NULL, 0, NULL, 0),
(72, 0, 67, 1, '大', '<p>\r\n	sda</p>\r\n', NULL, 1504076303, 2130706433, 3, 0, 0, 0, 0, 0, 0, NULL, 0, NULL, 0),
(73, 0, 67, 1, '大', '<p>\r\n	da</p>\r\n', NULL, 1504076368, 2130706433, 3, 0, 0, 0, 0, 0, 0, NULL, 0, NULL, 0),
(74, 0, 67, 1, '大', '<p>\r\n	da</p>\r\n', NULL, 1504076401, 2130706433, 3, 0, 0, 0, 0, 0, 0, NULL, 0, NULL, 0),
(75, 0, 66, 1, '打死', '<p>\r\n	dasd</p>\r\n', NULL, 1504076464, 2130706433, 3, 0, 0, 0, 0, 0, 0, NULL, 0, NULL, 0),
(76, 0, 66, 1, '打死', '<p>\r\n	dsad</p>\r\n', NULL, 1504076467, 2130706433, 3, 0, 0, 0, 0, 0, 0, NULL, 0, NULL, 0),
(77, 0, 66, 1, '打死', '<p>\r\n	dsa</p>\r\n', NULL, 1504076470, 2130706433, 3, 1, 2, 0, 0, 0, 0, NULL, 0, NULL, 0),
(78, 0, 65, 1, '2222222221', '<p>\r\n	sa</p>\r\n', NULL, 1504076591, 2130706433, 3, 0, 0, 0, 0, 0, 0, NULL, 0, NULL, 0),
(79, 0, 77, 1, '打死', '<p>\r\n	asd</p>\r\n', NULL, 1504080642, 2130706433, 3, 1, 2, 0, 0, 0, 0, NULL, 1, NULL, 0),
(80, 0, 79, 1, '打死', '<p>\r\n	dsada</p>\r\n', NULL, 1504080654, 2130706433, 3, 0, 0, 0, 0, 0, 0, NULL, 0, NULL, 0),
(81, 1, 0, 1, '可爱又迷人的反派角色', '<p>\r\n	这是测试哇</p>\r\n', NULL, 1504083857, 2130706433, 5, 0, 4, 0, 1, 0, 0, NULL, 0, NULL, 0),
(83, 0, 7, 1, '树操作算法，非递归方法', '<p>\r\n	发表</p>\r\n', NULL, 1504086746, 2130706433, 5, 0, 2, 0, 0, 0, 0, NULL, 1, NULL, 0),
(84, 0, 9, 1, '本论坛超管的账号、密码都为admin', '<p>\r\n	我是一个一号</p>\r\n', NULL, 1504091277, 2130706433, 5, 0, 0, 0, 0, 0, 0, NULL, 0, NULL, 0),
(85, 0, 52, 23, '啊啊', '<p>\r\n	sasa</p>\r\n', NULL, 1504091752, 2130706433, 4, 0, 0, 0, 0, 0, 0, NULL, 0, NULL, 0),
(86, 0, 61, 23, '可以啊', '<p>\r\n	打死</p>\r\n', NULL, 1504091769, 2130706433, 3, 0, 1, 0, 0, 0, 0, NULL, 1, NULL, 0),
(87, 0, 61, 23, '可以啊', '<p>\r\n	我是板凳</p>\r\n', NULL, 1504093213, 2130706433, 3, 0, 0, 0, 0, 0, 0, NULL, 0, NULL, 0),
(88, 0, 61, 23, '可以啊', '<p>\r\n	我是地板</p>\r\n', NULL, 1504093325, 2130706433, 3, 0, 0, 0, 0, 0, 0, NULL, 0, NULL, 0),
(89, 0, 61, 23, '可以啊', '<p>\r\n	黄维新很卡哇伊</p>\r\n', NULL, 1504093416, 2130706433, 3, 0, 0, 0, 0, 0, 0, NULL, 0, NULL, 0),
(90, 1, 0, 1, '可爱', '<p>\r\n	可爱</p>\r\n', NULL, 1504144469, 2130706433, 6, 0, 0, 1, 1, 0, 0, NULL, 0, NULL, 0),
(91, 1, 0, 0, '很(๑•̀ㅂ•́)و✧的', '<p>\r\n	可以飞得起</p>\r\n', NULL, 1504173542, 0, 7, 0, 0, 0, 0, 0, 0, NULL, 0, NULL, 0),
(92, 1, 0, 1, '可以的', '<p>\r\n	可以的</p>\r\n', NULL, 1504175396, 2130706433, 3, 0, 0, 0, 0, 0, 0, NULL, 0, NULL, 0),
(93, 1, 0, 1, '爱心', '<p>\r\n	爱心</p>\r\n', NULL, 1504175502, 2130706433, 3, 0, 1, 0, 0, 0, 0, NULL, 0, NULL, 0),
(94, 1, 0, 1, '可爱又迷人的反派角色', '<p>\r\n	可爱又迷人的反派角色</p>\r\n', NULL, 1504178962, 2130706433, 6, 0, 0, 0, 1, 0, 0, NULL, 0, NULL, 0),
(95, 1, 0, 26, '可以的', '<p>\r\n	可以</p>\r\n', NULL, 1504227838, 2130706433, 0, 0, 0, 0, 0, 0, 0, NULL, 0, NULL, 0),
(96, 1, 0, 26, '倒萨', '<p>\r\n	不行？</p>\r\n', NULL, 1504227882, 2130706433, 3, 1, 3, 0, 0, 0, 0, NULL, 0, NULL, 0),
(97, 1, 0, 26, '吖吖', '<p>\r\n	啊啊</p>\r\n', NULL, 1504228007, 2130706433, 3, 0, 1, 1, 1, 0, 0, NULL, 0, NULL, 0),
(98, 0, 9, 26, '本论坛超管的账号、密码都为admin', '<p>\r\n	我可以加</p>\r\n', NULL, 1504228048, 2130706433, 5, 0, 0, 0, 0, 0, 0, NULL, 0, NULL, 0),
(99, 0, 9, 26, '本论坛超管的账号、密码都为admin', '', NULL, 1504228060, 2130706433, 5, 0, 0, 0, 0, 0, 0, NULL, 0, NULL, 0),
(100, 1, 0, 1, '11', '<p>\r\n	w(ﾟДﾟ)w</p>\r\n', NULL, 1504229128, 2130706433, 11, 0, 0, 0, 0, 0, 0, NULL, 0, NULL, 0),
(101, 0, 96, 1, '倒萨', '<p>\r\n	可以把</p>\r\n', NULL, 1504229208, 2130706433, 3, 0, 0, 0, 0, 0, 0, NULL, 0, NULL, 0),
(102, 1, 0, 1, '不能么', '<p>\r\n	不能</p>\r\n', NULL, 1504229412, 2130706433, 14, 1, 2, 0, 0, 0, 0, NULL, 0, NULL, 0),
(103, 0, 102, 1, '不能么', '<p>\r\n	操蛋了</p>\r\n', NULL, 1504229424, 2130706433, 14, 0, 0, 0, 0, 0, 0, NULL, 0, NULL, 0),
(9, 1, 0, 1, '本论坛超管的账号、密码都为admin', '<p>\r\n 操作步骤：</p>\r\n<p>\r\n  1 先登陆到会员中心；</p>\r\n<p>\r\n  2 点击右上角&ldquo;管理中心&rdquo;再次登陆，即可进入后台操作界面；</p>', NULL, 1444301395, -1062731039, 5, 3, 34, 1, 1, 0, 0, NULL, 0, 'red', 0),
(10, 0, 6, 1, '', '<p>\r\n  <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">好东西~tukiz07&nbsp;&nbsp;爱死你了~</span></p>', NULL, 1444301807, -1062731039, 5, 0, 0, 0, 0, 0, 0, NULL, 0, NULL, 0),
(11, 0, 6, 9, '', '<p>\r\n  <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">比较强大</span></p>', NULL, 1444301822, -1062731039, 5, 0, 0, 0, 0, 0, 0, NULL, 0, NULL, 0),
(12, 0, 6, 9, '', '<p>\r\n  <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">看来数据量比我想象的要小很多</span></p>', NULL, 1444301843, -1062731039, 5, 0, 0, 0, 0, 0, 0, NULL, 0, NULL, 0),
(13, 0, 6, 1, '', '<p>\r\n  <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">不错，值得学习。压力测试很重要。另外我觉得把apache换成nginx是不是要快很多。不知道人家的架构设计怎么理解的，apache主要做什么，nginx主要做什么。</span></p>', NULL, 1444301862, -1062731039, 5, 0, 0, 0, 0, 0, 0, NULL, 0, NULL, 0),
(14, 0, 6, 9, '', '<p>\r\n  <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">用$globals、apc、 memcached..分级缓存我有个问题，就是怎么保证数据能够及时更新，比如用户修改完自己资料后，缓存中的数据应该就是最新的，难道要每个级别的缓存都清一次吗？</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">另外apc只能放在同一台机器上，那么多个服务器上的缓存怎么保持一致？</span><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n  <br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;" />\r\n <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">$globals能在同一个请求的上下文中缓存数据，但是如果中间有修改怎么办？</span></p>', NULL, 1444301876, -1062731039, 5, 0, 0, 0, 0, 0, 0, NULL, 0, NULL, 0),
(15, 0, 6, 9, '', '<p>\r\n  <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">学习了，谢谢</span></p>', NULL, 1444301891, -1062731039, 5, 0, 0, 0, 0, 0, 0, NULL, 1, NULL, 0),
(16, 0, 6, 9, '', '<p>\r\n  <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">很不错，谢谢分享。</span></p>', NULL, 1444301904, -1062731039, 5, 0, 0, 0, 0, 0, 0, NULL, 0, NULL, 0),
(17, 0, 6, 9, '', '<p>\r\n  <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">看不懂。但感觉很厉害的样子</span></p>', NULL, 1444301916, -1062731039, 5, 0, 0, 0, 0, 0, 0, NULL, 0, NULL, 1),
(18, 0, 6, 9, '', '<p>\r\n  <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">facebook用的是memcached缓存，现在网上说有更好地缓存了，叫redis的东西，这个比memcached更强大一些。</span></p>', NULL, 1444301934, -1062731039, 5, 0, 0, 0, 0, 0, 0, NULL, 0, NULL, 0),
(19, 0, 6, 9, '', '<p>\r\n  <span style="color: rgb(68, 68, 68); font-family: tahoma, \'microsoft yahei\', simsun; font-size: 14px; line-height: 21px;">太坑人了吧</span></p>', NULL, 1444301959, -1062731039, 5, 0, 0, 0, 0, 0, 0, NULL, 0, NULL, 0);

-- --------------------------------------------------------

--
-- 表的结构 `ip_close`
--

CREATE TABLE `ip_close` (
  `id` int(10) NOT NULL,
  `cip` int(200) NOT NULL COMMENT '黑名单ip',
  `addtime` int(200) NOT NULL COMMENT '添加时间',
  `overtime` int(200) NOT NULL COMMENT '结束时间'
) ENGINE=MyISAM DEFAULT CHARSET=utf8;

-- --------------------------------------------------------

--
-- 表的结构 `level`
--

CREATE TABLE `level` (
  `vid` int(11) NOT NULL COMMENT '等级ID',
  `level` tinyint(2) NOT NULL DEFAULT '1' COMMENT '等级',
  `picture` varchar(255) NOT NULL DEFAULT 'public/img/qt.jpg' COMMENT '等级1图',
  `name` varchar(20) NOT NULL DEFAULT '青铜'
) ENGINE=InnoDB DEFAULT CHARSET=utf8;

--
-- 转存表中的数据 `level`
--

INSERT INTO `level` (`vid`, `level`, `picture`, `name`) VALUES
(12, 1, 'public/img/qt.jpg', '青铜'),
(13, 2, 'public/img/by.jpg', '白银'),
(14, 3, 'public/img/gold.jpg', '黄金'),
(15, 4, 'public/img/dem.jpg', '钻石'),
(16, 5, 'public/img/zgn.jpg', '王者');

-- --------------------------------------------------------

--
-- 表的结构 `user`
--

CREATE TABLE `user` (
  `uid` int(11) NOT NULL,
  `username` char(16) NOT NULL COMMENT '账号',
  `password` char(32) NOT NULL COMMENT '密码md5',
  `email` char(30) DEFAULT NULL,
  `sex` tinyint(4) NOT NULL DEFAULT '0',
  `udertype` tinyint(2) NOT NULL DEFAULT '0' COMMENT '账号类型',
  `regtime` int(11) NOT NULL COMMENT '注册时间',
  `lasttime` int(12) DEFAULT NULL COMMENT '最后登陆时间',
  `ip` int(12) NOT NULL,
  `photo` varchar(100) NOT NULL DEFAULT 'default.gif',
  `grade` char(10) NOT NULL DEFAULT '0',
  `problem` varchar(200) DEFAULT NULL COMMENT '问题',
  `result` varchar(200) DEFAULT NULL COMMENT '答案',
  `place` varchar(50) DEFAULT NULL,
  `allowlogin` tinyint(2) DEFAULT '0' COMMENT '是否允许登录',
  `qq` int(13) DEFAULT NULL,
  `autograph` varchar(500) NOT NULL DEFAULT '。。。' COMMENT '个人签名',
  `realname` char(10) DEFAULT NULL,
  `safe` char(4) NOT NULL DEFAULT '公开' COMMENT '公开保密'
) ENGINE=MyISAM DEFAULT CHARSET=utf8;

--
-- 转存表中的数据 `user`
--

INSERT INTO `user` (`uid`, `username`, `password`, `email`, `sex`, `udertype`, `regtime`, `lasttime`, `ip`, `photo`, `grade`, `problem`, `result`, `place`, `allowlogin`, `qq`, `autograph`, `realname`, `safe`) VALUES
(1, 'admin', '21232f297a57a5a743894a0e4a801fc3', '913804005@qq.com', 1, 1, 1503000000, 1504247218, 2130706433, '59a7ba7456cb9.png', '113', NULL, NULL, NULL, 0, 913804005, '<p>\r\n	衣带渐宽终不悔，为伊消得人憔悴。<span style="background-color:#ffd700;"><img alt="indecision" height="20" src="http://www.yhz123.com/public/ckeditor/plugins/smiley/images/whatchutalkingabout_smile.gif" title="indecision" width="20" /></span></p>\r\n', '杨红藻', '公开'),
(23, 'user1', '24c9e15e52afc47c225b757e7bee1f9d', '913804005@qq.com', 0, 0, 1503969044, 1504183334, 2130706433, 'default.gif', '10', NULL, NULL, NULL, 0, NULL, '可爱又迷人', NULL, '公开'),
(24, 'user2', '7e58d63b60197ceb55a1c487989a3720', '913804005@qq.com', 0, 0, 1504177936, 1504184141, 2130706433, 'default.gif', '10', NULL, NULL, NULL, 0, NULL, '<p>\r\n	you&lsquo;re my superstar&hArr;<img alt="cool" height="20" src="http://www.yhz123.com/public/ckeditor/plugins/smiley/images/shades_smile.gif" title="cool" width="20" /></p>\r\n', NULL, '公开'),
(25, 'user3', '92877af70a45fd6a2ed7fe81e1236b78', '913804005@qq.com', 0, 0, 1504184345, 1504184393, 2130706433, 'default.gif', '10', NULL, NULL, NULL, 0, NULL, '。。。', NULL, '公开'),
(26, 'user5', '0a791842f52a0acfbb3a783378c066b8', '913804005@qq.com', 0, 0, 1504227764, 1504227987, 2130706433, '59a8b2646cd7f.png', '16', NULL, NULL, NULL, 0, NULL, '。。。', NULL, '公开');

-- --------------------------------------------------------

--
-- 表的结构 `web_info`
--

CREATE TABLE `web_info` (
  `wid` int(11) NOT NULL,
  `web_site` varchar(20) NOT NULL DEFAULT 'discuz论坛',
  `web_name` varchar(20) NOT NULL DEFAULT 'iott',
  `web_url` varchar(200) NOT NULL DEFAULT 'http://www.nice123.xin',
  `web_code` varchar(20) NOT NULL DEFAULT '	粤ICP备17104148号-1',
  `web_close` char(11) NOT NULL DEFAULT '1'
) ENGINE=MyISAM DEFAULT CHARSET=utf8;

--
-- 转存表中的数据 `web_info`
--

INSERT INTO `web_info` (`wid`, `web_site`, `web_name`, `web_url`, `web_code`, `web_close`) VALUES
(1, 'discuz论坛', 'iott', 'http://www.nice123.xin', '	粤ICP备17104148号-1', 'o');

--
-- Indexes for dumped tables
--

--
-- Indexes for table `bbs_link`
--
ALTER TABLE `bbs_link`
  ADD PRIMARY KEY (`lid`);

--
-- Indexes for table `cate_gory`
--
ALTER TABLE `cate_gory`
  ADD PRIMARY KEY (`cid`);

--
-- Indexes for table `details`
--
ALTER TABLE `details`
  ADD PRIMARY KEY (`id`);

--
-- Indexes for table `ip_close`
--
ALTER TABLE `ip_close`
  ADD PRIMARY KEY (`id`);

--
-- Indexes for table `level`
--
ALTER TABLE `level`
  ADD PRIMARY KEY (`vid`);

--
-- Indexes for table `user`
--
ALTER TABLE `user`
  ADD PRIMARY KEY (`uid`);

--
-- Indexes for table `web_info`
--
ALTER TABLE `web_info`
  ADD PRIMARY KEY (`wid`);

--
-- 在导出的表使用AUTO_INCREMENT
--

--
-- 使用表AUTO_INCREMENT `bbs_link`
--
ALTER TABLE `bbs_link`
  MODIFY `lid` smallint(6) NOT NULL AUTO_INCREMENT, AUTO_INCREMENT=9;
--
-- 使用表AUTO_INCREMENT `cate_gory`
--
ALTER TABLE `cate_gory`
  MODIFY `cid` int(10) NOT NULL AUTO_INCREMENT, AUTO_INCREMENT=15;
--
-- 使用表AUTO_INCREMENT `details`
--
ALTER TABLE `details`
  MODIFY `id` int(10) NOT NULL AUTO_INCREMENT, AUTO_INCREMENT=104;
--
-- 使用表AUTO_INCREMENT `ip_close`
--
ALTER TABLE `ip_close`
  MODIFY `id` int(10) NOT NULL AUTO_INCREMENT, AUTO_INCREMENT=4;
--
-- 使用表AUTO_INCREMENT `level`
--
ALTER TABLE `level`
  MODIFY `vid` int(11) NOT NULL AUTO_INCREMENT COMMENT '等级ID', AUTO_INCREMENT=17;
--
-- 使用表AUTO_INCREMENT `user`
--
ALTER TABLE `user`
  MODIFY `uid` int(11) NOT NULL AUTO_INCREMENT, AUTO_INCREMENT=27;
--
-- 使用表AUTO_INCREMENT `web_info`
--
ALTER TABLE `web_info`
  MODIFY `wid` int(11) NOT NULL AUTO_INCREMENT, AUTO_INCREMENT=2;
/*!40101 SET CHARACTER_SET_CLIENT=@OLD_CHARACTER_SET_CLIENT */;
/*!40101 SET CHARACTER_SET_RESULTS=@OLD_CHARACTER_SET_RESULTS */;
/*!40101 SET COLLATION_CONNECTION=@OLD_COLLATION_CONNECTION */;
